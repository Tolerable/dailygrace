<!DOCTYPE html>
<html lang="en">
<head>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-07DJKB5KLS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-07DJKB5KLS');
</script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- Primary Meta Tags -->
  <title>DailyGrace.Online - Your Personal Devotional Companion</title>
  <meta name="title" content="DailyGrace.Online - Your Personal Devotional Companion">
  <meta name="description" content="Free daily Christian devotions, AI-powered prayers, spiritual guidance, and peaceful meditation music. Personal devotional companion for your faith journey with Bible-based meditations, interactive prayer tools, and soothing instrumental tracks.">
  <meta name="keywords" content="daily devotions, Christian prayers, spiritual meditation, AI ministry, Bible study, faith journey, devotional app, prayer companion, Christian meditation, spiritual guidance, daily Bible verse, Christian devotional, prayer generator, faith-based AI, free devotions, meditation music, peaceful music, worship music, Christian instrumental, relaxation music">
  <meta name="author" content="DailyGrace.Online - AI Ministries">
  <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
  <meta name="language" content="English">
  <meta name="revisit-after" content="7 days">
  <meta name="distribution" content="global">
  <meta name="rating" content="general">
  <meta name="theme-color" content="#2E86AB">
  
  <!-- Canonical URL -->
  <link rel="canonical" href="https://www.dailygrace.online/">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="DailyGrace.Online">
  <meta property="og:locale" content="en_US">
  <meta property="og:url" content="https://www.dailygrace.online/">
  <meta property="og:title" content="DailyGrace.Online - Your Personal Devotional Companion">
  <meta property="og:description" content="Free daily Christian devotions, AI-powered prayers, spiritual guidance, and peaceful meditation music. Personal devotional companion for your faith journey with Bible-based meditations, interactive prayer tools, and soothing tracks.">
  <meta property="og:image" content="https://www.dailygrace.online/img/DailyGrace.jpg?v=3">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:alt" content="DailyGrace.Online - Christian Devotional App">
  <meta property="article:publisher" content="https://www.dailygrace.online">
  
  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@dailygrace">
  <meta name="twitter:creator" content="@dailygrace">
  <meta name="twitter:url" content="https://www.dailygrace.online/">
  <meta name="twitter:title" content="DailyGrace.Online - Your Personal Devotional Companion">
  <meta name="twitter:description" content="Free daily Christian devotions, AI-powered prayers, spiritual guidance, and peaceful meditation music. Personal devotional companion for your faith journey with Bible-based meditations, interactive prayer tools, and soothing tracks.">
  <meta name="twitter:image" content="https://www.dailygrace.online/img/DailyGrace.jpg?v=3">
  <meta name="twitter:image:alt" content="DailyGrace.Online - Christian Devotional App">
  
  <!-- Discord -->
  <meta name="discord:card" content="summary_large_image">
  <meta name="discord:title" content="DailyGrace.Online - Your Personal Devotional Companion">
  <meta name="discord:description" content="Free daily Christian devotions, AI-powered prayers, spiritual guidance, and peaceful meditation music.">
  <meta name="discord:image" content="https://www.dailygrace.online/img/DailyGrace.jpg?v=3">
  
  <!-- Apple/Mobile Meta -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="DailyGrace.Online">
  <meta name="msapplication-TileColor" content="#2E86AB">
  
  <!-- Structured Data for Search Engines -->
	<script type="application/ld+json">
	{
	  "@context": "https://schema.org",
	  "@type": "WebSite",
	  "name": "DailyGrace.Online",
	  "alternateName": "Daily Grace Devotional",
	  "description": "Free daily Christian devotions, AI-powered prayers, and spiritual guidance. Personal devotional companion for your faith journey.",
	  "url": "https://www.dailygrace.online",
	  "image": "https://www.dailygrace.online/img/DailyGrace.jpg",
	  "sameAs": [
		"https://ai-ministries.com"
	  ],
	  "publisher": {
		"@type": "Organization",
		"name": "DailyGrace.Online",
		"url": "https://www.dailygrace.online"
	  },
	  "potentialAction": {
		"@type": "SearchAction",
		"target": "https://www.dailygrace.online/?q={search_term_string}",
		"query-input": "required name=search_term_string"
	  }
	}
	</script>

	<script type="application/ld+json">
	{
	  "@context": "https://schema.org",
	  "@type": "ReligiousOrganization",
	  "name": "DailyGrace.Online",
	  "description": "AI-powered Christian devotional and prayer companion providing free daily spiritual guidance",
	  "url": "https://www.dailygrace.online",
	  "logo": "https://www.dailygrace.online/img/DailyGrace.jpg",
	  "sameAs": [
		"https://ai-ministries.com"
	  ],
	  "contactPoint": {
		"@type": "ContactPoint",
		"email": "contact@dailygrace.online",
		"contactType": "Customer Service"
	  },
	  "hasOfferCatalog": {
		"@type": "OfferCatalog",
		"name": "Spiritual Services",
		"itemListElement": [
		  {
			"@type": "Offer",
			"itemOffered": {
			  "@type": "Service",
			  "name": "Daily Devotions",
			  "description": "AI-generated Christian devotions"
			}
		  },
		  {
			"@type": "Offer",
			"itemOffered": {
			  "@type": "Service",
			  "name": "Prayer Assistance",
			  "description": "Interactive prayer creation and guidance"
			}
		  },
		  {
			"@type": "Offer",
			"itemOffered": {
			  "@type": "Service",
			  "name": "Meditation Music",
			  "description": "Peaceful instrumental and vocal tracks for prayer and meditation"
			}
		  }
		]
	  }
	}
	</script>
  
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <style>
  
    /* Enhanced Daily Grace Styles */
    :root {
      --primary-blue: #2E86AB;
      --soft-blue: #A8DADC;
      --warm-cream: #F1FAEE;
      --sage-green: #457B9D;
      --deep-navy: #1D3557;
      --gold-accent: #E9C46A;
      --soft-pink: #F4ACB7;
      --text-dark: #2C3E50;
      --text-light: #FFFFFF;
      --shadow-light: rgba(0, 0, 0, 0.1);
      --shadow-medium: rgba(0, 0, 0, 0.15);
      --gradient-primary: linear-gradient(135deg, var(--primary-blue), var(--sage-green));
      --gradient-soft: linear-gradient(135deg, var(--soft-blue), var(--warm-cream));
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      line-height: 1.6;
      color: var(--text-dark);
      background: var(--warm-cream);
      overflow-x: hidden;
    }

    /* Header & Navigation */
    .header {
      background: var(--gradient-primary);
      color: var(--text-light);
      padding: 1rem 0;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 10px var(--shadow-light);
    }

    .nav-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      font-size: 1.8rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      cursor: pointer;
    }

    .logo-icon {
      width: 32px;
      height: 32px;
      background: var(--text-light);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--primary-blue);
      font-weight: bold;
    }

    .nav-menu {
      display: flex;
      list-style: none;
      gap: 2rem;
      align-items: center;
    }

    .nav-menu a {
      color: var(--text-light);
      text-decoration: none;
      font-weight: 500;
      transition: opacity 0.3s ease;
      cursor: pointer;
    }

    .nav-menu a:hover {
      opacity: 0.8;
    }

    /* Main Container */
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem 1rem;
    }

    /* Section Styles */
    .section {
      display: none;
      animation: fadeIn 0.5s ease-in;
    }

    .section.active {
      display: block;
    }

    /* Welcome Section */
    .welcome-section {
      text-align: center;
      padding: 3rem 0;
    }

    .time-greeting {
      font-size: 2.5rem;
      color: var(--deep-navy);
      margin-bottom: 1rem;
    }

    .daily-verse {
      background: var(--text-light);
      padding: 2rem;
      border-radius: 16px;
      margin: 2rem 0;
      box-shadow: 0 4px 16px var(--shadow-light);
    }

    /* Devotion Card */
    .devotion-card {
      background: var(--text-light);
      border-radius: 20px;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: 0 8px 32px var(--shadow-light);
    }

    .devotion-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }

    .devotion-date {
      color: var(--sage-green);
      font-size: 0.9rem;
    }

    .devotion-image {
      width: 100%;
      height: auto;
      aspect-ratio: 16/9;
      border-radius: 12px;
      object-fit: cover;
      margin-bottom: 1.5rem;
      box-shadow: 0 4px 16px var(--shadow-light);
    }

    .devotion-content h3 {
      color: var(--deep-navy);
      font-size: 1.5rem;
      margin-bottom: 1rem;
    }

    .scripture-reference {
      color: var(--sage-green);
      font-style: italic;
      margin-bottom: 1rem;
    }

    .devotion-text {
      color: var(--text-dark);
      line-height: 1.8;
      white-space: pre-wrap;
    }

    .delete-button {
        position: absolute;
        top: 0.5rem;
        right: 0.5rem;
        width: 30px;
        height: 30px;
        background: #dc2626;
        color: white;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        transition: background 0.3s ease;
        opacity: 0.8;
    }

    .delete-button:hover {
        background: #b91c1c;
        opacity: 1;
    }

    .history-item {
        position: relative;
    }

    /* Audio Player */
    .audio-player {
      background: var(--gradient-soft);
      border-radius: 16px;
      padding: 1.5rem;
      margin-top: 1.5rem;
    }

    .audio-controls {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .play-button {
      width: 50px;
      height: 50px;
      background: var(--gradient-primary);
      border: none;
      border-radius: 50%;
      color: var(--text-light);
      font-size: 1.2rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.3s ease;
    }

    .play-button:hover {
      transform: scale(1.05);
    }

    .progress-container {
      flex: 1;
      height: 6px;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 3px;
      overflow: hidden;
      cursor: pointer;
    }

    .progress-bar {
      height: 100%;
      background: var(--text-light);
      width: 0%;
      transition: width 0.1s ease;
    }

    .time-display {
      font-size: 0.9rem;
      color: var(--text-dark);
    }

    /* Prayer Creator */
    .prayer-creator {
        background: var(--text-light);
        border-radius: 16px;
        padding: 2rem;
        margin-bottom: 2rem;
        box-shadow: 0 4px 16px var(--shadow-light);
    }

    .prayer-request-section {
        background: var(--gradient-soft);
        border-radius: 12px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
    }

    .prayer-request-input {
        width: 100%;
        min-height: 80px;
        padding: 0.75rem;
        border: 2px solid var(--soft-blue);
        border-radius: 8px;
        font-family: inherit;
        font-size: 0.95rem;
        resize: vertical;
        background: var(--text-light);
    }

    .prayer-textarea {
        width: 100%;
        min-height: 300px; /* Doubled from 150px */
        padding: 1rem;
        border: 2px solid var(--soft-blue);
        border-radius: 12px;
        font-family: inherit;
        font-size: 1rem;
        resize: vertical;
        transition: border-color 0.3s ease;
        background: var(--text-light);
    }

    .prayer-textarea:focus {
        outline: none;
        border-color: var(--primary-blue);
    }

    .section-label {
        font-weight: 600;
        color: var(--deep-navy);
        margin-bottom: 0.5rem;
        display: block;
    }

    /* History Grid */
    .history-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
      margin-top: 2rem;
    }

    .history-item {
      background: var(--text-light);
      border-radius: 12px;
      padding: 1.5rem;
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      box-shadow: 0 2px 8px var(--shadow-light);
    }

    .history-item:hover {
      transform: translateY(-4px);
      box-shadow: 0 6px 20px var(--shadow-medium);
    }

    .history-item-type {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      background: var(--gradient-primary);
      color: var(--text-light);
      border-radius: 20px;
      font-size: 0.8rem;
      margin-bottom: 0.5rem;
    }

    .history-item-title {
      font-weight: 600;
      color: var(--deep-navy);
      margin-bottom: 0.5rem;
    }

    .history-item-date {
      font-size: 0.85rem;
      color: var(--sage-green);
    }

    /* Buttons */
    .btn {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 50px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 1rem;
    }

    .btn-primary {
      background: var(--gradient-primary);
      color: var(--text-light);
      box-shadow: 0 4px 16px rgba(46, 134, 171, 0.3);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(46, 134, 171, 0.4);
    }

    .btn-secondary {
      background: var(--text-light);
      color: var(--primary-blue);
      border: 2px solid var(--primary-blue);
    }

    .btn-secondary:hover {
      background: var(--primary-blue);
      color: var(--text-light);
    }

    .btn-accent {
      background: var(--gold-accent);
      color: var(--text-dark);
    }

    .btn-accent:hover {
      background: #E0B555;
      transform: translateY(-2px);
    }

    .btn-group {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      margin-top: 1.5rem;
    }

    /* Action Grid */
	.action-grid {
	  display: grid;
	  grid-template-columns: repeat(3, 1fr);
	  gap: 1.5rem;
	  margin: 2rem 0;
	}

    .action-card {
      background: var(--text-light);
      border-radius: 16px;
      padding: 2rem;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 16px var(--shadow-light);
    }

    .action-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 24px var(--shadow-medium);
    }

    .action-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
    }

    .action-title {
      font-size: 1.2rem;
      color: var(--deep-navy);
      margin-bottom: 0.5rem;
    }

    .action-description {
      color: var(--text-dark);
      opacity: 0.8;
      font-size: 0.9rem;
    }

    /* Loading States */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255, 255, 255, 0.95);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      display: none;
    }

    .loading-overlay.active {
      display: flex;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 4px solid var(--soft-blue);
      border-top: 4px solid var(--primary-blue);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 1rem;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .loading-text {
      color: var(--sage-green);
      font-weight: 500;
    }

    /* Modals */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 999;
      padding: 1rem;
      overflow-y: auto;
    }

    .modal.active {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      background: var(--text-light);
      border-radius: 20px;
      padding: 2rem;
      max-width: 800px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      position: relative;
    }

    .modal-close {
      position: absolute;
      top: 1rem;
      right: 1rem;
      width: 40px;
      height: 40px;
      background: var(--soft-blue);
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      transition: background 0.3s ease;
    }

    .modal-close:hover {
      background: var(--primary-blue);
      color: var(--text-light);
    }

	/* Bible Section Styles */
	.bible-controls {
	  display: grid;
	  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
	  gap: 1rem;
	  margin-bottom: 2rem;
	  background: var(--text-light);
	  padding: 1.5rem;
	  border-radius: 12px;
	}

	.bible-controls select {
	  width: 100%;
	  padding: 0.75rem;
	  border: 2px solid var(--soft-blue);
	  border-radius: 8px;
	  font-family: inherit;
	  background: var(--text-light);
	}

	.reading-mode {
	  text-align: center;
	  margin-bottom: 2rem;
	}

	.mode-buttons {
	  display: flex;
	  gap: 1rem;
	  justify-content: center;
	  flex-wrap: wrap;
	  margin-top: 1rem;
	}

	.bible-player {
	  background: var(--text-light);
	  border-radius: 16px;
	  padding: 2rem;
	  margin-bottom: 2rem;
	  box-shadow: 0 4px 16px var(--shadow-light);
	}

	.current-passage {
	  text-align: center;
	  margin-bottom: 2rem;
	}

	.current-passage h3 {
	  color: var(--deep-navy);
	  margin-bottom: 1rem;
	}

	.current-passage p {
	  font-size: 1.1rem;
	  line-height: 1.8;
	  color: var(--text-dark);
	  font-style: italic;
	}

	.bible-audio-controls {
	  display: flex;
	  justify-content: center;
	  gap: 1rem;
	  margin-bottom: 1.5rem;
	}

	.bible-btn {
	  width: 50px;
	  height: 50px;
	  border: none;
	  border-radius: 50%;
	  background: var(--sage-green);
	  color: var(--text-light);
	  font-size: 1.2rem;
	  cursor: pointer;
	  transition: all 0.3s ease;
	  display: flex;
	  align-items: center;
	  justify-content: center;
	}

	.bible-btn:hover {
	  transform: scale(1.05);
	}

	.bible-btn.active {
	  background: var(--gold-accent);
	  color: var(--deep-navy);
	}

	.passage-info {
	  display: flex;
	  justify-content: space-between;
	  margin-top: 0.5rem;
	  font-size: 0.9rem;
	  color: var(--sage-green);
	}

	.verse-list {
	  background: var(--text-light);
	  border-radius: 12px;
	  padding: 1.5rem;
	  max-height: 400px;
	  overflow-y: auto;
	}

	.verse-item {
	  padding: 0.75rem;
	  border-bottom: 1px solid var(--soft-blue);
	  cursor: pointer;
	  transition: background 0.3s ease;
	}

	.verse-item:hover {
	  background: var(--warm-cream);
	}

	.verse-item.playing {
	  background: var(--soft-blue);
	  color: var(--deep-navy);
	}

	.verse-reference {
	  font-weight: 600;
	  color: var(--sage-green);
	  margin-bottom: 0.25rem;
	}

    /* Utility Classes */
    .hidden { display: none !important; }
    .text-center { text-align: center; }
    .mt-2 { margin-top: 2rem; }
    .mb-2 { margin-bottom: 2rem; }

	/* Music Section Styles */
	.music-grid {
	  display: grid;
	  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
	  gap: 1.5rem;
	  margin: 2rem 0;
	}

	.music-card {
	  background: var(--text-light);
	  border-radius: 16px;
	  padding: 2rem;
	  text-align: center;
	  cursor: pointer;
	  transition: all 0.3s ease;
	  box-shadow: 0 4px 16px var(--shadow-light);
	  position: relative;
	  overflow: hidden;
	}

	.music-card::before {
	  content: '';
	  position: absolute;
	  top: 0;
	  left: -100%;
	  width: 100%;
	  height: 100%;
	  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
	  transition: left 0.6s ease;
	}

	.music-card:hover::before {
	  left: 100%;
	}

	.music-card:hover {
	  transform: translateY(-4px);
	  box-shadow: 0 8px 24px var(--shadow-medium);
	}

	.music-icon {
	  font-size: 3rem;
	  margin-bottom: 1rem;
	  filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
	}

	.music-title {
	  font-size: 1.3rem;
	  color: var(--deep-navy);
	  margin-bottom: 0.5rem;
	  font-weight: 600;
	}

	.music-description {
	  color: var(--sage-green);
	  opacity: 0.9;
	  margin-bottom: 0.5rem;
	  font-style: italic;
	}

	.music-duration {
	  color: var(--text-dark);
	  opacity: 0.7;
	  font-size: 0.9rem;
	  font-weight: 500;
	}

	/* Music Player Modal */
	.music-player-modal {
	  display: none;
	  position: fixed;
	  top: 0;
	  left: 0;
	  right: 0;
	  bottom: 0;
	  background: rgba(0, 0, 0, 0.8);
	  z-index: 1000;
	  backdrop-filter: blur(10px);
	}

	.music-player-modal.active {
	  display: flex;
	  align-items: center;
	  justify-content: center;
	  animation: fadeIn 0.3s ease;
	}

	.music-player-content {
	  background: var(--text-light);
	  border-radius: 24px;
	  padding: 2.5rem;
	  max-width: 450px;
	  width: 90%;
	  position: relative;
	  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
	}

	.current-track-info {
	  text-align: center;
	  margin-bottom: 2rem;
	}

	.track-icon {
	  font-size: 4rem;
	  margin-bottom: 1rem;
	}

	.music-controls {
	  display: flex;
	  justify-content: center;
	  gap: 1rem;
	  margin-bottom: 2rem;
	}

	.music-btn {
	  width: 60px;
	  height: 60px;
	  border: none;
	  border-radius: 50%;
	  background: var(--gradient-primary);
	  color: var(--text-light);
	  font-size: 1.5rem;
	  cursor: pointer;
	  transition: all 0.3s ease;
	  display: flex;
	  align-items: center;
	  justify-content: center;
	}

	.music-btn:hover {
	  transform: scale(1.05);
	  box-shadow: 0 4px 16px rgba(46, 134, 171, 0.4);
	}

	.music-btn.active {
	  background: var(--gold-accent);
	  color: var(--deep-navy);
	}

	.progress-section {
	  margin-bottom: 1.5rem;
	}

	.time-info {
	  display: flex;
	  justify-content: space-between;
	  margin-top: 0.5rem;
	  font-size: 0.9rem;
	  color: var(--sage-green);
	}

	.timer-section {
	  text-align: center;
	  padding-top: 1.5rem;
	  border-top: 1px solid var(--soft-blue);
	}

	.timer-options {
	  display: flex;
	  gap: 0.5rem;
	  justify-content: center;
	  flex-wrap: wrap;
	  margin: 1rem 0;
	}

	.timer-btn {
	  padding: 0.5rem 1rem;
	  border: 2px solid var(--primary-blue);
	  background: var(--text-light);
	  color: var(--primary-blue);
	  border-radius: 20px;
	  cursor: pointer;
	  transition: all 0.3s ease;
	  font-size: 0.9rem;
	}

	.timer-btn:hover {
	  background: var(--primary-blue);
	  color: var(--text-light);
	}

	#timer-display {
	  color: var(--sage-green);
	  font-weight: 500;
	  margin-top: 1rem;
	}

/* Spiritual Guidance Chat Interface */
	.chat-container {
	  max-width: 1000px;
	  margin: 0 auto;
	  height: 70vh;
	  min-height: 500px;
	  max-height: 800px;
	  display: flex;
	  flex-direction: column;
	  background: var(--text-light);
	  border-radius: 16px;
	  box-shadow: 0 4px 16px var(--shadow-light);
	  overflow: hidden;
	}

	.chat-messages {
	  flex: 1;
	  overflow-y: auto;
	  padding: 1.5rem;
	  display: flex;
	  flex-direction: column;
	  gap: 1rem;
	  background: var(--warm-cream);
	  scroll-behavior: smooth;
	}

	.message {
	  max-width: 80%;
	  animation: fadeInUp 0.3s ease;
	}

	.user-message {
	  align-self: flex-end;
	}

	.bot-message {
	  align-self: flex-start;
	}

	.user-message .message-content {
	  background: var(--primary-blue);
	  color: var(--text-light);
	  padding: 1rem 1.25rem;
	  border-radius: 18px 18px 4px 18px;
	  box-shadow: 0 2px 8px rgba(46, 134, 171, 0.3);
	}

	.bot-message .message-content {
	  background: var(--text-light);
	  color: var(--text-dark);
	  padding: 1.25rem 1.5rem;
	  border-radius: 18px 18px 18px 4px;
	  box-shadow: 0 2px 8px var(--shadow-light);
	  border-left: 4px solid var(--gold-accent);
	  line-height: 1.7;
	}

	.message-content p {
	  margin: 0 0 0.75rem 0;
	  line-height: 1.7;
	}

	.message-content p:last-child {
	  margin-bottom: 0;
	}

	.message-content + .message-actions {
	  margin-top: 0.5rem;
	  text-align: right;
	}

	.message-actions {
	  display: flex;
	  gap: 0.5rem;
	  justify-content: flex-end;
	  margin-top: 0.5rem;
	}

	.message-action-btn {
	  background: none;
	  border: none;
	  color: var(--sage-green);
	  cursor: pointer;
	  font-size: 0.8rem;
	  padding: 0.25rem 0.5rem;
	  border-radius: 12px;
	  transition: all 0.3s ease;
	}

	.message-action-btn:hover {
	  background: var(--soft-blue);
	  color: var(--deep-navy);
	}

	.chat-input-area {
	  background: var(--text-light);
	  border-top: 1px solid var(--soft-blue);
	  padding: 1.25rem;
	  flex-shrink: 0;
	}

	.input-container {
	  display: flex;
	  gap: 1rem;
	  align-items: flex-end;
	  max-width: 100%;
	}

	.chat-input {
	  flex: 1;
	  min-height: 52px;
	  max-height: 120px;
	  padding: 1rem 1.25rem;
	  border: 2px solid var(--soft-blue);
	  border-radius: 26px;
	  font-family: inherit;
	  font-size: 1rem;
	  resize: none;
	  transition: border-color 0.3s ease;
	  background: var(--warm-cream);
	  line-height: 1.4;
	}

	.chat-input:focus {
	  outline: none;
	  border-color: var(--primary-blue);
	}

	.send-button {
	  background: var(--gradient-primary);
	  color: var(--text-light);
	  border: none;
	  border-radius: 26px;
	  padding: 1rem 1.5rem;
	  font-weight: 600;
	  cursor: pointer;
	  transition: all 0.3s ease;
	  display: flex;
	  align-items: center;
	  gap: 0.5rem;
	  min-width: 90px;
	  justify-content: center;
	  height: 52px;
	}

	.send-button:hover {
	  transform: translateY(-2px);
	  box-shadow: 0 4px 16px rgba(46, 134, 171, 0.4);
	}

	.send-button:disabled {
	  opacity: 0.6;
	  cursor: not-allowed;
	  transform: none;
	}

	.send-icon {
	  font-size: 1rem;
	}

	.welcome-message {
	  text-align: center;
	  margin-bottom: 1rem;
	}

	.typing-indicator {
	  display: flex;
	  align-items: center;
	  gap: 0.5rem;
	  padding: 1rem 1.25rem;
	  background: var(--text-light);
	  border-radius: 18px 18px 18px 4px;
	  box-shadow: 0 2px 8px var(--shadow-light);
	  border-left: 4px solid var(--gold-accent);
	  max-width: 80%;
	}

	.typing-dots {
	  display: flex;
	  gap: 4px;
	}

	.typing-dot {
	  width: 8px;
	  height: 8px;
	  background: var(--sage-green);
	  border-radius: 50%;
	  animation: typingPulse 1.4s infinite ease-in-out;
	}

	.typing-dot:nth-child(2) {
	  animation-delay: 0.2s;
	}

	.typing-dot:nth-child(3) {
	  animation-delay: 0.4s;
	}

	@keyframes typingPulse {
	  0%, 60%, 100% {
		transform: scale(1);
		opacity: 0.5;
	  }
	  30% {
		transform: scale(1.2);
		opacity: 1;
	  }
	}

	@keyframes fadeInUp {
	  from {
		opacity: 0;
		transform: translateY(10px);
	  }
	  to {
		opacity: 1;
		transform: translateY(0);
	  }
	}

	.recent-sessions {
	  margin-top: 2rem;
	  max-width: 1000px;
	  margin-left: auto;
	  margin-right: auto;
	}

	/* Style for scripture references */
	.message-content em,
	.message-content i {
	  color: var(--sage-green);
	  font-style: italic;
	}

	/* Radio Station Styles */
	.radio-station {
	  position: fixed;
	  right: -320px;
	  top: 50%;
	  transform: translateY(-50%);
	  z-index: 998;
	  transition: right 0.3s ease;
	}

	.radio-station.open {
	  right: 0;
	}

	.radio-toggle {
	  position: absolute;
	  left: -60px;
	  top: 50%;
	  transform: translateY(-50%) rotate(-90deg);
	  background: var(--gradient-primary);
	  color: var(--text-light);
	  padding: 0.75rem 1.5rem;
	  border-radius: 12px 12px 0 0;
	  cursor: pointer;
	  display: flex;
	  align-items: center;
	  gap: 0.5rem;
	  font-weight: 600;
	  box-shadow: -2px 0 8px var(--shadow-light);
	  transition: all 0.3s ease;
	}

	.radio-toggle:hover {
	  left: -65px;
	}

	.radio-icon {
	  font-size: 1.2rem;
	}

	.radio-panel {
	  width: 320px;
	  background: var(--text-light);
	  border-radius: 16px 0 0 16px;
	  box-shadow: -4px 0 16px var(--shadow-medium);
	  height: 500px;
	  display: flex;
	  flex-direction: column;
	}

	.radio-header {
	  background: var(--gradient-primary);
	  color: var(--text-light);
	  padding: 1rem;
	  border-radius: 16px 0 0 0;
	  display: flex;
	  justify-content: space-between;
	  align-items: center;
	}

	.radio-header h3 {
	  margin: 0;
	  font-size: 1.2rem;
	}

	.radio-close {
	  background: none;
	  border: none;
	  color: var(--text-light);
	  font-size: 1.5rem;
	  cursor: pointer;
	  width: 30px;
	  height: 30px;
	  display: flex;
	  align-items: center;
	  justify-content: center;
	  border-radius: 50%;
	  transition: background 0.3s ease;
	}

	.radio-close:hover {
	  background: rgba(255, 255, 255, 0.2);
	}

	.radio-content {
	  flex: 1;
	  padding: 1.5rem;
	  overflow-y: auto;
	}

	.now-playing {
	  background: var(--gradient-soft);
	  padding: 1rem;
	  border-radius: 12px;
	  margin-bottom: 1.5rem;
	  text-align: center;
	}

	.now-playing-label {
	  font-size: 0.8rem;
	  color: var(--sage-green);
	  margin-bottom: 0.25rem;
	}

	.now-playing-title {
	  font-weight: 600;
	  color: var(--deep-navy);
	  font-size: 1.1rem;
	}

	.station-selector {
	  margin-bottom: 1.5rem;
	}

	.station-selector label {
	  display: block;
	  font-weight: 600;
	  color: var(--deep-navy);
	  margin-bottom: 0.75rem;
	}

	.station-buttons {
	  display: flex;
	  flex-direction: column;
	  gap: 0.5rem;
	}

	.station-btn {
	  background: var(--warm-cream);
	  border: 2px solid var(--soft-blue);
	  padding: 0.75rem;
	  border-radius: 8px;
	  cursor: pointer;
	  transition: all 0.3s ease;
	  font-size: 0.95rem;
	  text-align: left;
	}

	.station-btn:hover {
	  background: var(--soft-blue);
	}

	.station-btn.active {
	  background: var(--primary-blue);
	  color: var(--text-light);
	  border-color: var(--primary-blue);
	}

	.radio-controls {
	  display: flex;
	  justify-content: center;
	  gap: 1rem;
	  margin-bottom: 1rem;
	}

	.radio-btn {
	  width: 50px;
	  height: 50px;
	  border: none;
	  border-radius: 50%;
	  background: var(--sage-green);
	  color: var(--text-light);
	  font-size: 1.2rem;
	  cursor: pointer;
	  transition: all 0.3s ease;
	  display: flex;
	  align-items: center;
	  justify-content: center;
	}

	.radio-btn:hover {
	  transform: scale(1.05);
	  background: var(--primary-blue);
	}

	.volume-control {
	  margin-bottom: 1rem;
	}

	.volume-control input[type="range"] {
	  width: 100%;
	  height: 6px;
	  background: var(--soft-blue);
	  border-radius: 3px;
	  outline: none;
	  -webkit-appearance: none;
	}

	.volume-control input[type="range"]::-webkit-slider-thumb {
	  -webkit-appearance: none;
	  width: 16px;
	  height: 16px;
	  background: var(--primary-blue);
	  border-radius: 50%;
	  cursor: pointer;
	}

	.radio-progress {
	  margin-bottom: 1rem;
	}

	.radio-time {
	  display: flex;
	  justify-content: space-between;
	  font-size: 0.8rem;
	  color: var(--sage-green);
	  margin-top: 0.25rem;
	}

	.up-next {
	  background: var(--warm-cream);
	  padding: 0.75rem;
	  border-radius: 8px;
	  font-size: 0.9rem;
	}

	.up-next-label {
	  font-size: 0.8rem;
	  color: var(--sage-green);
	  margin-bottom: 0.25rem;
	}

	.up-next-title {
	  color: var(--deep-navy);
	}

	/* Mobile adjustments */
	@media (max-width: 768px) {
	  .radio-panel {
		width: 280px;
	  }
	  
	  .radio-station {
		right: -280px;
	  }
	}

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Responsive */
    @media (max-width: 768px) {
      .nav-menu {
        flex-wrap: wrap;
        gap: 1rem;
        font-size: 0.9rem;
      }
      
      .time-greeting {
        font-size: 2rem;
      }
      
      .action-grid {
        grid-template-columns: 1fr;
      }
      
      .btn-group {
        flex-direction: column;
      }
      
      .audio-controls {
        flex-wrap: wrap;
      }
      
      .progress-container {
        width: 100%;
        order: 3;
      }

	  .chat-container {
		height: 60vh;
		min-height: 400px;
		max-height: 600px;
		margin: 0 -0.5rem;
		border-radius: 12px;
		max-width: none;
	  }
	  
	  .message {
		max-width: 90%;
	  }
	  
	  .chat-messages {
		padding: 1rem;
	  }
	  
	  .chat-input-area {
		padding: 1rem;
	  }
	  
	  .input-container {
		gap: 0.75rem;
	  }
	  
	  .send-button {
		min-width: 80px;
		padding: 1rem;
	  }

	  footer {
		padding: 2rem 0 1.5rem 0 !important;
	  }
	  
	  footer div[style*="grid-template-columns"] {
		grid-template-columns: 1fr !important;
		gap: 1.5rem !important;
	  }
	  
	  footer a[style*="display: inline-flex"] {
		display: block !important;
		text-align: center;
		width: fit-content;
		margin: 0 auto;
	  }
    }

	@media (max-width: 480px) {
	  .input-container {
		flex-direction: column;
		gap: 0.75rem;
	  }
	  
	  .send-button {
		align-self: stretch;
		min-width: auto;
	  }
	}

	@media (max-width: 900px) {
	  .action-grid {
		grid-template-columns: repeat(2, 1fr);
	  }
	}

	@media (max-width: 600px) {
	  .action-grid {
		grid-template-columns: 1fr;
	  }
	}
  </style>
</head>
<body>
  <header class="header">
    <nav class="nav-container">
      <div class="logo" onclick="app.showSection('home')">
        <div class="logo-icon">✝</div>
        DailyGrace.Online
      </div>
		<ul class="nav-menu">
		  <li><a onclick="app.showSection('home')">Home</a></li>
		  <li><a onclick="app.showSection('devotions')">Devotions</a></li>
		  <li><a onclick="app.showSection('prayers')">Prayers</a></li>
		  <li><a onclick="app.showSection('music')">Peaceful Music</a></li>
		  <li><a onclick="app.showSection('bible')">Audio Bible</a></li>
  		  <li><a onclick="app.showSection('guidance')">Guidance</a></li>
		  <li><a onclick="app.showSection('history')">My Journey</a></li>
		</ul>
    </nav>
  </header>

  <!-- Spiritual Guidance Section -->
  <section id="guidance-section" class="section">
    <h2 class="text-center mb-2">Spiritual Guidance</h2>
    <p class="text-center" style="margin-bottom: 2rem; opacity: 0.8;">
      Share what's on your heart and receive biblical wisdom and encouragement
    </p>
    
    <!-- Chat Interface -->
    <div class="chat-container">
      <div class="chat-messages" id="chat-messages">
        <div class="welcome-message">
          <div class="message bot-message">
            <div class="message-content">
              <p>🕊️ Welcome to your spiritual guidance companion. I'm here to listen with compassion and share biblical wisdom. What's on your heart today?</p>
            </div>
          </div>
        </div>
      </div>
      
      <div class="chat-input-area">
        <div class="input-container">
			<textarea 
			  class="chat-input" 
			  id="guidance-input" 
			  placeholder="Share your struggles, doubts, questions, or any burden you're carrying...
			Please remember, NEVER share personal identifying information."
			  rows="3"
			></textarea>
          <button class="send-button" onclick="app.seekGuidance()" id="send-btn">
            <span class="send-icon">📤</span>
            Send
          </button>
        </div>
      </div>
    </div>
    
    <!-- Recent Sessions -->
    <div class="recent-sessions" id="guidance-history-section" style="display: none;">
      <h3 style="text-align: center; margin: 2rem 0 1rem 0;">Recent Guidance Sessions</h3>
      <div id="guidance-history" class="history-grid"></div>
    </div>
  </section>

  <main class="container">
    <!-- Home Section -->
    <section id="home-section" class="section active">
      <div class="welcome-section">
        <h1 class="time-greeting" id="time-greeting">Welcome to DailyGrace.Online</h1>
        <p id="time-message">Find peace and inspiration in God's word</p>
        
        <div class="daily-verse" id="daily-verse">
          <p class="scripture-reference">Loading today's verse...</p>
          <p class="devotion-text"></p>
        </div>

        <div class="action-grid">
		  <div class="action-card" onclick="app.showSection('devotions')">
		  	<div class="action-icon">🌅</div>
		  	<h3 class="action-title">Today's Devotion</h3>
		  	<p class="action-description">Receive a fresh word from the Lord</p>
		  </div>
          
          <div class="action-card" onclick="app.showSection('prayers'); app.showPrayerCreator()">
            <div class="action-icon">🙏</div>
            <h3 class="action-title">Write a Prayer</h3>
            <p class="action-description">Express your heart to God</p>
          </div>
          
          <div class="action-card" onclick="app.showSection('history')">
            <div class="action-icon">📖</div>
            <h3 class="action-title">My Journey</h3>
            <p class="action-description">Revisit past devotions and prayers</p>
          </div>
		  
		  <div class="action-card" onclick="app.showSection('music')">
		    <div class="action-icon">🎵</div>
		    <h3 class="action-title">Peaceful Music</h3>
		    <p class="action-description">Soothing sounds for prayer and meditation</p>
		  </div>

		  <div class="action-card" onclick="app.showSection('bible')">
			<div class="action-icon">📖</div>
			<h3 class="action-title">Audio Bible</h3>
			<p class="action-description">Listen to God's Word with AI narration</p>
		  </div>

		  <div class="action-card" onclick="app.showSection('guidance')">
			<div class="action-icon">🤝</div>
			<h3 class="action-title">Spiritual Guidance</h3>
			<p class="action-description">Share your heart and receive biblical wisdom</p>
		  </div>
		  
        </div>
      </div>
    </section>

    <!-- Devotions Section -->
	<section id="devotions-section" class="section">
		<div id="devotion-container"></div>
		
		<div class="text-center mt-2">
			<button class="btn btn-primary" onclick="app.createNewDevotion()">
				🌟 New Devotion
			</button>
		</div>
	</section>

    <!-- Prayers Section -->
    <section id="prayers-section" class="section">
        <h2 class="text-center mb-2">Prayer Corner</h2>
        
        <div class="prayer-creator" id="prayer-creator">
            <div class="prayer-request-section">
                <label class="section-label">What would you like to pray about?</label>
                <textarea 
                    class="prayer-request-input" 
                    id="prayer-request-input" 
                    placeholder="Share your heart... (e.g., 'Help me pray for rain and good harvests' or 'I need strength during a difficult time')"
                ></textarea>
                <button class="btn btn-secondary mt-2" onclick="app.requestPrayerHelp()">
                    ✨ Create Prayer from My Request
                </button>
            </div>
            
            <div>
                <label class="section-label">Your Prayer</label>
                <textarea 
                    class="prayer-textarea" 
                    id="prayer-input" 
                    placeholder="Write your prayer here, or use the AI assistant above to help create one based on your needs..."
                ></textarea>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" onclick="app.savePrayer()">
                    💾 Save Prayer
                </button>
                <button class="btn btn-accent" onclick="app.listenToPrayer()">
                    🎧 Listen to Prayer
                </button>
            </div>
        </div>
        
        <div id="saved-prayers" class="history-grid mt-2"></div>
    </section>

	<!-- Peaceful Music Section -->
	<section id="music-section" class="section">
	  <h2 class="text-center mb-2">Peaceful Music for Prayer & Meditation</h2>
	  <p class="text-center" style="margin-bottom: 2rem; opacity: 0.8;">
		Soothing instrumental tracks to enhance your spiritual time
	  </p>
	  
	  <div class="music-grid">
		<div class="music-card" onclick="app.playTrack('gentle-streams')">
		  <div class="music-icon">🌊</div>
		  <h3 class="music-title">Gentle Streams</h3>
		  <p class="music-description">Soft piano with nature sounds</p>
		  <p class="music-duration">4:49</p>
		</div>

		<div class="music-card" onclick="app.playTrack('heavenly-peace')">
		  <div class="music-icon">☁️</div>
		  <h3 class="music-title">Heavenly Peace</h3>
		  <p class="music-description">Ambient choir and strings</p>
		  <p class="music-duration">3:59</p>
		</div>

		<div class="music-card" onclick="app.playTrack('morning-light')">
		  <div class="music-icon">🌅</div>
		  <h3 class="music-title">Morning Light</h3>
		  <p class="music-description">Uplifting acoustic guitar</p>
		  <p class="music-duration">4:00</p>
		</div>

		<div class="music-card" onclick="app.playTrack('quiet-sanctuary')">
		  <div class="music-icon">🕊️</div>
		  <h3 class="music-title">Quiet Sanctuary</h3>
		  <p class="music-description">Meditative bells and pads</p>
		  <p class="music-duration">3:22</p>
		</div>
		
		<div class="music-card" onclick="app.playTrack('sacred-waters')">
		  <div class="music-icon">💧</div>
		  <h3 class="music-title">Sacred Waters</h3>
		  <p class="music-description">Flowing water with gentle harp</p>
		  <p class="music-duration">2:49</p>
		</div>

		<div class="music-card" onclick="app.playTrack('peaceful-garden')">
		  <div class="music-icon">🌿</div>
		  <h3 class="music-title">Peaceful Garden</h3>
		  <p class="music-description">Nature sounds with soft flute</p>
		  <p class="music-duration">4:08</p>
		</div>		
	  </div>

		<!-- Add this after the closing </div> of the first music-grid -->

		<h3 class="text-center" style="margin: 3rem 0 1rem 0; color: var(--deep-navy);">Worship Songs with Vocals</h3>
		<p class="text-center" style="margin-bottom: 2rem; opacity: 0.8;">
		  Inspirational worship music with lyrics for prayer and reflection
		</p>

		<div class="music-grid">
		  <div class="music-card" onclick="app.playTrack('rest-in-his-presence', true)">
			<img src="/img/RestinHisPresence.jpg" alt="Rest in His Presence" style="width: 100%; height: 200px; object-fit: cover; border-radius: 12px; margin-bottom: 1rem;">
			<h3 class="music-title">Rest in His Presence</h3>
			<p class="music-description">Finding peace in God's embrace</p>
			<p class="music-duration">4:00</p>
		  </div>

		  <div class="music-card" onclick="app.playTrack('morning-mercies', true)">
			<img src="/img/MorningMercies.jpg" alt="Morning Mercies" style="width: 100%; height: 200px; object-fit: cover; border-radius: 12px; margin-bottom: 1rem;">
			<h3 class="music-title">Morning Mercies</h3>
			<p class="music-description">God's faithfulness each new day</p>
			<p class="music-duration">3:45</p>
		  </div>

		  <div class="music-card" onclick="app.playTrack('healing-waters', true)">
			<img src="/img/HealingWaters.jpg" alt="Healing Waters" style="width: 100%; height: 200px; object-fit: cover; border-radius: 12px; margin-bottom: 1rem;">
			<h3 class="music-title">Healing Waters</h3>
			<p class="music-description">Restoration for the soul</p>
			<p class="music-duration">4:15</p>
		  </div>

		  <div class="music-card" onclick="app.playTrack('abide-in-me', true)">
			<img src="/img/AbideinMe.jpg" alt="Abide in Me" style="width: 100%; height: 200px; object-fit: cover; border-radius: 12px; margin-bottom: 1rem;">
			<h3 class="music-title">Abide in Me</h3>
			<p class="music-description">Dwelling in Christ's love</p>
			<p class="music-duration">3:30</p>
		  </div>

		  <div class="music-card" onclick="app.playTrack('peace-be-still', true)">
			<img src="/img/PeaceBeStill.jpg" alt="Peace Be Still" style="width: 100%; height: 200px; object-fit: cover; border-radius: 12px; margin-bottom: 1rem;">
			<h3 class="music-title">Peace Be Still</h3>
			<p class="music-description">Calm in life's storms</p>
			<p class="music-duration">4:30</p>
		  </div>

		  <div class="music-card" onclick="app.playTrack('come-away-with-me', true)">
			<img src="/img/ComeAwayWithMe.jpg" alt="Come Away With Me" style="width: 100%; height: 200px; object-fit: cover; border-radius: 12px; margin-bottom: 1rem;">
			<h3 class="music-title">Come Away With Me</h3>
			<p class="music-description">Jesus' gentle invitation</p>
			<p class="music-duration">3:50</p>
		  </div>
		</div>
	  
	  <!-- Music Player Modal -->
	  <div class="music-player-modal" id="music-player-modal">
		<div class="music-player-content">
		  <button class="modal-close" onclick="app.closeMusicPlayer()">×</button>
		  
		  <div class="current-track-info">
			<div class="track-icon" id="current-track-icon">🌊</div>
			<h3 id="current-track-title">Track Title</h3>
			<p id="current-track-description">Track Description</p>
		  </div>
		  
		  <div class="music-controls">
			<button class="music-btn" onclick="app.togglePlayPause()" id="play-pause-btn">▶️</button>
			<button class="music-btn" onclick="app.toggleLoop()" id="loop-btn">🔁</button>
			<button class="music-btn" onclick="app.showTimer()" id="timer-btn" title="Set meditation timer">⏰</button>
		  </div>
		  
		  <div class="progress-section">
			<div class="progress-container" onclick="app.seekTrack(event)">
			  <div class="progress-bar" id="music-progress"></div>
			</div>
			<div class="time-info">
			  <span id="current-time">0:00</span>
			  <span id="total-time">0:00</span>
			</div>
		  </div>
		  
			<div class="timer-section hidden" id="timer-section">
			  <h4>Meditation Timer</h4>
			  <div class="timer-options">
				<button class="timer-btn" onclick="app.setTimer(5)">5 min</button>
				<button class="timer-btn" onclick="app.setTimer(10)">10 min</button>
				<button class="timer-btn" onclick="app.setTimer(15)">15 min</button>
				<button class="timer-btn" onclick="app.setTimer(30)">30 min</button>
				<button class="timer-btn" onclick="app.cancelTimer()">Cancel</button>
			  </div>
			  <p id="timer-display" class="hidden">Timer: <span id="timer-countdown"></span></p>
			</div>
		  
		  <audio id="music-audio" preload="none"></audio>
		</div>
	  </div>
	</section>

	<!-- Bible Audio Section -->
	<section id="bible-section" class="section">
	  <h2 class="text-center mb-2">Audio Bible</h2>
	  <p class="text-center" style="margin-bottom: 2rem; opacity: 0.8;">
		Listen to God's Word with AI narration
	  </p>
	  
	  <!-- Bible Version Selector -->
	  <div class="bible-controls" id="bible-controls">
		<div class="version-selector">
		  <label class="section-label">Bible Version:</label>
		  <select id="bible-version" onchange="app.loadBibleBooks()">
			<option value="kjv">King James Version (KJV)</option>
			<option value="asv">American Standard Version (ASV)</option>
			<option value="ylt">Young's Literal Translation (YLT)</option>
			<option value="lxx">Septuagint (LXX)</option>
		  </select>
		</div>
		
		<!-- Book Selector -->
		<div class="book-selector">
		  <label class="section-label">Book:</label>
		  <select id="bible-book" onchange="app.loadChapters()">
			<option value="">Select a Book</option>
		  </select>
		</div>
		
		<!-- Chapter Selector -->
		<div class="chapter-selector">
		  <label class="section-label">Chapter:</label>
		  <select id="bible-chapter" onchange="app.loadVerses()">
			<option value="">Select Chapter</option>
		  </select>
		</div>
	  </div>
	  
	  <!-- Reading Mode Options -->
	  <div class="reading-mode" id="bible-instructions">
		<h3>What would you like to listen to?</h3>
		<div class="mode-buttons">
		  <button class="btn btn-secondary" onclick="app.setReadingMode('verse')">Individual Verses</button>
		  <button class="btn btn-secondary" onclick="app.setReadingMode('chapter')">Entire Chapter</button>
		  <button class="btn btn-secondary" onclick="app.setReadingMode('book')">Entire Book</button>
		</div>
	  </div>
	  
	  <!-- Bible Player -->
	  <div class="bible-player hidden" id="bible-player">
		<div class="current-passage">
		  <h3 id="current-reference">Genesis 1:1</h3>
		  <p id="current-text">In the beginning God created the heaven and the earth.</p>
		</div>
		
		<div class="bible-audio-controls">
			<button class="play-button" onclick="app.playCurrentPassage()" id="bible-play-btn">▶️</button>
			<button class="bible-btn" onclick="app.previousPassage()">⏮️</button>
			<button class="bible-btn" onclick="app.nextPassage()">⏭️</button>
			<button class="bible-btn" onclick="app.toggleAutoPlay()" id="auto-play-btn">🔄</button>
			<button class="bible-btn" onclick="app.redoCurrentPassage()" title="Regenerate audio">🔁</button>
		</div>
		
		<div class="progress-section">
		  <div class="progress-container">
			<div class="progress-bar" id="bible-progress"></div>
		  </div>
		  <div class="passage-info">
			<span id="passage-position">Verse 1 of 31</span>
			<span id="bible-time">0:00 / 0:00</span>
		  </div>
		</div>
		
		<audio id="bible-audio" preload="none"></audio>
	  </div>
	  
	  <!-- Verse List for Individual Mode -->
	  <div class="verse-list hidden" id="verse-list"></div>
	</section>

    <!-- History Section -->
    <section id="history-section" class="section">
      <h2 class="text-center mb-2">My Spiritual Journey</h2>
      
		<div class="btn-group text-center">
		  <button class="btn btn-secondary" onclick="app.filterHistory('all')">All</button>
		  <button class="btn btn-secondary" onclick="app.filterHistory('devotion')">Devotions</button>
		  <button class="btn btn-secondary" onclick="app.filterHistory('prayer')">Prayers</button>
		  <button class="btn btn-secondary" onclick="app.filterHistory('guidance')">Guidance</button>
		</div>
      
      <div id="history-container" class="history-grid"></div>
    </section>

  <!-- Radio Station Panel -->
  <div id="radio-station" class="radio-station">
    <div class="radio-toggle" onclick="app.toggleRadio()">
      <span class="radio-icon">📻</span>
      <span class="radio-label">Grace Radio</span>
    </div>
    
    <div class="radio-panel">
      <div class="radio-header">
        <h3>Grace Radio 24/7</h3>
        <button class="radio-close" onclick="app.toggleRadio()">×</button>
      </div>
      
      <div class="radio-content">
        <!-- Current Playing -->
        <div class="now-playing">
          <div class="now-playing-label">Now Playing:</div>
          <div class="now-playing-title" id="radio-now-playing">Loading...</div>
        </div>
        
        <!-- Station Selector -->
        <div class="station-selector">
          <label>Choose Station:</label>
          <div class="station-buttons">
            <button class="station-btn active" onclick="app.setRadioStation('mixed')">
              🎵 Mixed Worship
            </button>
            <button class="station-btn" onclick="app.setRadioStation('instrumental')">
              🎹 Instrumental Only
            </button>
            <button class="station-btn" onclick="app.setRadioStation('vocals')">
              🎤 Vocals Only
            </button>
          </div>
        </div>
        
        <!-- Radio Controls -->
        <div class="radio-controls">
          <button class="radio-btn" onclick="app.toggleRadioPlayPause()" id="radio-play-btn">
            ▶️
          </button>
          <button class="radio-btn" onclick="app.skipRadioTrack()">
            ⏭️
          </button>
          <button class="radio-btn" onclick="app.toggleRadioMute()" id="radio-mute-btn">
            🔊
          </button>
        </div>
        
        <!-- Volume Control -->
        <div class="volume-control">
          <input type="range" id="radio-volume" min="0" max="100" value="70" 
                 oninput="app.setRadioVolume(this.value)">
        </div>
        
        <!-- Progress -->
        <div class="radio-progress">
          <div class="progress-container">
            <div class="progress-bar" id="radio-progress-bar"></div>
          </div>
          <div class="radio-time">
            <span id="radio-current-time">0:00</span>
            <span id="radio-total-time">0:00</span>
          </div>
        </div>
        
        <!-- Up Next -->
        <div class="up-next">
          <div class="up-next-label">Up Next:</div>
          <div class="up-next-title" id="radio-up-next">...</div>
        </div>
      </div>
    </div>
    
    <!-- Hidden audio element -->
    <audio id="radio-audio" preload="auto"></audio>
  </div>

  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loading">
    <div class="spinner"></div>
    <p class="loading-text" id="loading-text">Creating your blessing...</p>
  </div>

  <!-- Detail Modal -->
  <div class="modal" id="detail-modal">
    <div class="modal-content">
      <button class="modal-close" onclick="app.closeModal()">×</button>
      <div id="modal-body"></div>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div class="modal" id="delete-modal">
      <div class="modal-content" style="max-width: 400px;">
          <h3 style="color: var(--deep-navy); margin-bottom: 1rem;">Delete Item?</h3>
          <p style="margin-bottom: 1.5rem;">Are you sure you want to delete this <span id="delete-item-type"></span>?</p>
          <div class="btn-group" style="justify-content: center;">
              <button class="btn btn-secondary" onclick="app.cancelDelete()">Cancel</button>
              <button class="btn btn-primary" style="background: #dc2626;" onclick="app.confirmDelete()">Delete</button>
          </div>
      </div>
  </div>
  </main>
  <script>
    // Enhanced Daily Grace App
    class DailyGraceApp {
	  constructor() {
	  	this.db = null;
	  	this.currentSection = 'home';
	  	this.currentAudio = null;
	  	this.isPlaying = false;
		this.radioStation = 'mixed';
		this.radioPlaylist = [];
		this.radioCurrentIndex = 0;
		this.radioAudio = null;
		this.isRadioPlaying = false;
		this.radioVolume = 0.7;
		this.cutInterval = 3; // Play a cut every 3 songs
		this.songsSinceCut = 0;
	  	this.currentFilter = 'all';
	  	this.pendingDeleteId = null; 
	  	this.init();
	  }

	  async init() {
	  	await this.initDatabase();
	  	this.updateTimeGreeting();
	  	this.loadDailyVerse();
	  	this.bindEvents();
	  	this.setCopyrightYear();
	  	this.initRadio(); // Add this line
	  	setInterval(() => this.updateTimeGreeting(), 60000);
	  }

	  showPrivacyPolicy() {
		const modal = document.getElementById('detail-modal');
		const modalBody = document.getElementById('modal-body');
		  
	    modalBody.innerHTML = `
		<div style="max-width: 600px;">
		  <h2 style="color: var(--deep-navy); margin-bottom: 2rem;">Privacy Policy</h2>
		  
		  <h3 style="color: var(--sage-green); margin: 1.5rem 0 1rem 0;">Information We Collect</h3>
		  <p style="line-height: 1.6; margin-bottom: 1rem;">
			DailyGrace.Online stores your devotions and prayers locally on your device using your browser's storage. 
			We do not collect personal information or transmit your spiritual content to external servers.
		  </p>
		  
		  <h3 style="color: var(--sage-green); margin: 1.5rem 0 1rem 0;">Analytics and Tracking</h3>
		  <p style="line-height: 1.6; margin-bottom: 1rem;">
			We use Google Analytics to understand how visitors use our website. This service collects 
			anonymous data about page views, session duration, and general location (country/city level). 
			We've configured Google Analytics to operate without cookies for your privacy. 
			No personal information is collected or stored by this service.
		  </p>
		  
			<h3 style="color: var(--sage-green); margin: 1.5rem 0 1rem 0;">How We Use Information</h3>
			<p style="line-height: 1.6; margin-bottom: 1rem;">
			  Your devotions and prayers are stored locally on your device. When you request AI-generated 
			  prayers, guidance, or audio, we send your requests to Pollinations.ai for processing. 
			  We have no control over how long Pollinations.ai caches or stores these requests. 
			  Please be mindful of what personal information you share.
			</p>
		  
		  <h3 style="color: var(--sage-green); margin: 1.5rem 0 1rem 0;">Cookies</h3>
		  <p style="line-height: 1.6; margin-bottom: 1rem;">
			We use minimal browser storage to save your content locally. No tracking cookies are used.
		  </p>
		  
		  <h3 style="color: var(--sage-green); margin: 1.5rem 0 1rem 0;">Contact</h3>
		  <p style="line-height: 1.6;">
			For questions about privacy, contact us at 
			<a href="mailto:contact@dailygrace.online" style="color: var(--primary-blue);">contact@dailygrace.online</a>
		  </p>
		  
		  <p style="font-size: 0.9rem; color: var(--sage-green); margin-top: 2rem;">
			Last updated: June 2025
		  </p>
		</div>
		`;
	    
	    modal.classList.add('active');
	  }
			  
	  showTermsOfService() {
	    const modal = document.getElementById('detail-modal');
	    const modalBody = document.getElementById('modal-body');
	    
	    modalBody.innerHTML = `
	  	<div style="max-width: 600px;">
	  	  <h2 style="color: var(--deep-navy); margin-bottom: 2rem;">Terms of Service</h2>
	  	  
	  	  <h3 style="color: var(--sage-green); margin: 1.5rem 0 1rem 0;">Acceptance of Terms</h3>
	  	  <p style="line-height: 1.6; margin-bottom: 1rem;">
	  		By using DailyGrace.Online, you agree to these terms. This service is provided free of charge 
	  		as a ministry tool for personal spiritual growth.
	  	  </p>
	  	  
	  	  <h3 style="color: var(--sage-green); margin: 1.5rem 0 1rem 0;">Use of Service</h3>
	  	  <p style="line-height: 1.6; margin-bottom: 1rem;">
	  		DailyGrace.Online is intended for personal devotional use. The AI-generated content is meant to 
	  		inspire and supplement your personal relationship with God, not replace biblical study or pastoral guidance.
	  	  </p>
	  	  
	  	  <h3 style="color: var(--sage-green); margin: 1.5rem 0 1rem 0;">Content Disclaimer</h3>
	  	  <p style="line-height: 1.6; margin-bottom: 1rem;">
	  		While we strive for biblical accuracy, AI-generated content should be considered supplementary. 
	  		Always verify spiritual guidance with scripture and trusted spiritual advisors.
	  	  </p>
	  	  
	  	  <h3 style="color: var(--sage-green); margin: 1.5rem 0 1rem 0;">Donations</h3>
	  	  <p style="line-height: 1.6; margin-bottom: 1rem;">
	  		Donations are voluntary and help maintain the service. No features are restricted based on donation status.
	  	  </p>
	  	  
	  	  <p style="font-size: 0.9rem; color: var(--sage-green); margin-top: 2rem;">
	  		Last updated: June 2025
	  	  </p>
	  	</div>
	    `;
	    
	    modal.classList.add('active');
	  }
	  
	  showCookiePolicy() {
		  const modal = document.getElementById('detail-modal');
		  const modalBody = document.getElementById('modal-body');
		  
		  modalBody.innerHTML = `
			<div style="max-width: 600px;">
			  <h2 style="color: var(--deep-navy); margin-bottom: 2rem;">Cookie Policy</h2>
			  
			  <h3 style="color: var(--sage-green); margin: 1.5rem 0 1rem 0;">What Are Cookies</h3>
			  <p style="line-height: 1.6; margin-bottom: 1rem;">
				DailyGrace.Online uses your browser's local storage (not traditional cookies) to save your devotions 
				and prayers on your device. This data never leaves your device.
			  </p>
			  
			  <h3 style="color: var(--sage-green); margin: 1.5rem 0 1rem 0;">Analytics</h3>
			  <p style="line-height: 1.6; margin-bottom: 1rem;">
				While we use Google Analytics to improve our service, we've configured it to run in a 
				cookieless mode. This means no tracking cookies are placed on your device for analytics purposes. 
				Only anonymous, aggregated data about site usage is collected.
			  </p>
			  
			  <h3 style="color: var(--sage-green); margin: 1.5rem 0 1rem 0;">How We Use Local Storage</h3>
			  <ul style="line-height: 1.6; margin-bottom: 1rem; padding-left: 1.5rem;">
				<li>Store your personal devotions and prayers</li>
				<li>Remember your preferences (if any)</li>
				<li>Enable offline functionality</li>
			  </ul>
			  
			  <h3 style="color: var(--sage-green); margin: 1.5rem 0 1rem 0;">Managing Storage</h3>
			  <p style="line-height: 1.6; margin-bottom: 1rem;">
				You can clear your stored data through your browser settings. This will remove all saved 
				devotions and prayers from your device.
			  </p>
			  
				<h3 style="color: var(--sage-green); margin: 1.5rem 0 1rem 0;">Third-Party Services</h3>
				<p style="line-height: 1.6;">
				  We use Pollinations.ai for AI content generation and text-to-speech. When you request 
				  prayers, guidance, or audio, your text is sent to their servers. Pollinations.ai may 
				  cache these requests. We recommend not sharing sensitive personal information. 
				  For their data practices, visit Pollinations.ai's own policies.
				</p>
			  
			  <p style="font-size: 0.9rem; color: var(--sage-green); margin-top: 2rem;">
				Last updated: June 2025
			  </p>
			</div>
		  `;
		  
		  modal.classList.add('active');
	  }
	  
	  sendEmail() {
	    const user = 'contact';
	    const domain = 'dailygrace.online';
	    window.location.href = `mailto:${user}@${domain}`;
	  }

	  setCopyrightYear() {
	  	const currentYear = new Date().getFullYear();
	  	const nextYear = currentYear + 1;
	  	document.getElementById('copyright-year').textContent = `${currentYear}-${nextYear}`;
	  }

      // Database Management
      async initDatabase() {
        return new Promise((resolve, reject) => {
          const request = indexedDB.open('DailyGraceDB', 1);
          
          request.onerror = () => reject(request.error);
          request.onsuccess = () => {
            this.db = request.result;
            resolve();
          };
          
          request.onupgradeneeded = (event) => {
            const db = event.target.result;
            
            if (!db.objectStoreNames.contains('content')) {
              const store = db.createObjectStore('content', { keyPath: 'id', autoIncrement: true });
              store.createIndex('type', 'type', { unique: false });
              store.createIndex('date', 'date', { unique: false });
            }
          };
        });
      }

      async saveContent(content) {
        return new Promise((resolve, reject) => {
          const transaction = this.db.transaction(['content'], 'readwrite');
          const store = transaction.objectStore('content');
          const request = store.add(content);
          
          request.onsuccess = () => resolve(request.result);
          request.onerror = () => reject(request.error);
        });
      }

      async getAllContent(type = null) {
        return new Promise((resolve, reject) => {
          const transaction = this.db.transaction(['content'], 'readonly');
          const store = transaction.objectStore('content');
          const request = type ? store.index('type').getAll(type) : store.getAll();
          
          request.onsuccess = () => {
            const results = request.result.sort((a, b) => b.date - a.date);
            resolve(results);
          };
          request.onerror = () => reject(request.error);
        });
      }

      async getContentById(id) {
        return new Promise((resolve, reject) => {
          const transaction = this.db.transaction(['content'], 'readonly');
          const store = transaction.objectStore('content');
          const request = store.get(id);
          
          request.onsuccess = () => resolve(request.result);
          request.onerror = () => reject(request.error);
        });
      }

	  // Bible Reading Methods
	  async loadBibleBooks() {
		const version = document.getElementById('bible-version').value;
		
		try {
			// REMOVE THIS LINE: document.getElementById('bible-loading').style.display = 'block';
			
			const response = await fetch(`/bible/${version}.txt`);
			const text = await response.text();
			
			// Parse books from the text
			this.bibleData = this.parseBibleText(text);
			
			const bookSelect = document.getElementById('bible-book');
			bookSelect.innerHTML = '<option value="">Select a Book</option>';
			
			Object.keys(this.bibleData).forEach(book => {
				const option = document.createElement('option');
				option.value = book;
				option.textContent = book;
				bookSelect.appendChild(option);
			});
			
			// REMOVE THIS LINE: document.getElementById('bible-loading').style.display = 'none';
			document.getElementById('bible-controls').style.display = 'grid';
			document.getElementById('bible-instructions').style.display = 'block';
			
		} catch (error) {
			console.error('Failed to load Bible:', error);
			// REMOVE THIS LINE: document.getElementById('bible-loading').innerHTML = '<p style="color: red;">Failed to load Bible. Please try again.</p>';
		}
	  }

	  showVerseList() {
		  const verseListContainer = document.getElementById('verse-list');
		  verseListContainer.classList.remove('hidden');
		  
		  verseListContainer.innerHTML = this.currentPassages.map((passage, index) => `
			<div class="verse-item" onclick="app.playSpecificVerse(${index})">
			  <div class="verse-reference">${passage.reference}</div>
			  <div class="verse-text">${passage.text}</div>
			</div>
		  `).join('');
	  }

	  playSpecificVerse(index) {
		  this.currentIndex = index;
		  this.playCurrentPassage();
		  
		  // Update visual state
		  document.querySelectorAll('.verse-item').forEach((item, i) => {
			item.classList.toggle('playing', i === index);
		  });
	  }

	  parseBibleText(text) {
		const lines = text.split('\n');
		const books = {};
		
		lines.forEach(line => {
			if (line.trim() && line.includes('\t')) {
				const [reference, verse] = line.split('\t');
				
				// Match book name (everything before the last space and numbers)
				const match = reference.match(/^(.+)\s+(\d+):(\d+)$/);
				if (match) {
					const book = match[1];
					const chapter = match[2];
					const verseNum = match[3];
					
					if (!books[book]) books[book] = {};
					if (!books[book][chapter]) books[book][chapter] = {};
					
					books[book][chapter][verseNum] = verse;
				}
			}
		});
		
		return books;
	  }

	  loadChapters() {
		  const book = document.getElementById('bible-book').value;
		  if (!book || !this.bibleData[book]) return;
		  
		  const chapterSelect = document.getElementById('bible-chapter');
		  chapterSelect.innerHTML = '<option value="">Select Chapter</option>';
		  
		  Object.keys(this.bibleData[book]).forEach(chapter => {
			const option = document.createElement('option');
			option.value = chapter;
			option.textContent = `Chapter ${chapter}`;
			chapterSelect.appendChild(option);
		  });
	  }

	  loadVerses() {
		  const book = document.getElementById('bible-book').value;
		  const chapter = document.getElementById('bible-chapter').value;
		  
		  if (!book || !chapter) return;
		  
		  this.currentPassages = [];
		  const verses = this.bibleData[book][chapter];
		  
		  Object.keys(verses).forEach(verseNum => {
			this.currentPassages.push({
			  reference: `${book} ${chapter}:${verseNum}`,
			  text: verses[verseNum],
			  book, chapter, verse: verseNum
			});
		  });
		  this.saveBiblePosition();
	  }

	  setReadingMode(mode) {
		  const book = document.getElementById('bible-book').value;
		  const chapter = document.getElementById('bible-chapter').value;
		  
		  if (!book || !chapter) {
			alert('Please select a book and chapter first!');
			return;
		  }
		  
		  this.readingMode = mode;
		  this.autoPlay = (mode !== 'verse');
		  this.currentIndex = 0;
		  
		  // Load appropriate passages based on mode
		  if (mode === 'verse') {
			this.loadVerses(); // Load just the selected chapter
			this.showVerseList();
		  } else if (mode === 'chapter') {
			this.loadVerses(); // Same as verse mode but will auto-play through
			document.getElementById('verse-list').classList.add('hidden');
		  } else if (mode === 'book') {
			this.loadEntireBook(book);
			document.getElementById('verse-list').classList.add('hidden');
		  }
		  
		  // Show player
		  document.getElementById('bible-player').classList.remove('hidden');
	  }

	  loadEntireBook(book) {
		  this.currentPassages = [];
		  const chapters = this.bibleData[book];
		  
		  Object.keys(chapters).forEach(chapterNum => {
			const verses = chapters[chapterNum];
			Object.keys(verses).forEach(verseNum => {
			  this.currentPassages.push({
				reference: `${book} ${chapterNum}:${verseNum}`,
				text: verses[verseNum],
				book, chapter: chapterNum, verse: verseNum
			  });
			});
		  });
	  }

	  saveBiblePosition() {
		  const position = {
			version: document.getElementById('bible-version').value,
			book: document.getElementById('bible-book').value,
			chapter: document.getElementById('bible-chapter').value,
			lastAccessed: Date.now()
		  };
		  localStorage.setItem('biblePosition', JSON.stringify(position));
	  }

	  loadBiblePosition() {
		const saved = localStorage.getItem('biblePosition');
		if (saved) {
			const position = JSON.parse(saved);
			document.getElementById('bible-version').value = position.version || 'kjv';
			if (position.book) {
				document.getElementById('bible-book').value = position.book;
				this.loadChapters();
				if (position.chapter) {
					setTimeout(() => {
						document.getElementById('bible-chapter').value = position.chapter;
						this.loadVerses();
					}, 100);
				}
			}
		}
	  }

	  async playCurrentPassage(forceSeed = null) {
		if (!this.currentPassages || this.currentPassages.length === 0) return;
		
		const audio = document.getElementById('bible-audio');
		const playBtn = document.getElementById('bible-play-btn');
		
		// If audio is playing, pause it
		if (!audio.paused && !forceSeed) {
			audio.pause();
			playBtn.textContent = '▶️';
			return;
		}
		
		const passage = this.currentPassages[this.currentIndex];
		
		// Update UI
		document.getElementById('current-reference').textContent = passage.reference;
		document.getElementById('current-text').textContent = passage.text;
		document.getElementById('passage-position').textContent = 
			`${this.readingMode === 'verse' ? 'Verse' : 'Passage'} ${this.currentIndex + 1} of ${this.currentPassages.length}`;
		
		// Generate audio URL with seed
		const cleanText = passage.text.replace(/\[|\]/g, '').replace(/\s+/g, ' ').trim();
		const transcriptionInstruction = "READ THIS TEXT VERBATIM WITHOUT ANY COMMENTARY OR RESPONSE:";
		const textToRead = transcriptionInstruction + " " + cleanText;
		
		const seed = forceSeed || passage.lastSeed || Math.floor(Math.random() * 10000);
		passage.lastSeed = seed; // Store the seed for this passage
		
		const encodedText = encodeURIComponent(textToRead);
		const audioUrl = `https://text.pollinations.ai/${encodedText}?model=openai-audio&voice=nova&seed=${seed}`;
		
		audio.src = audioUrl;
		
		// Setup audio events
		audio.onended = () => {
			playBtn.textContent = '▶️';
			// Only auto-advance if autoPlay is on AND not in verse mode
			if (this.autoPlay && this.readingMode !== 'verse' && this.currentIndex < this.currentPassages.length - 1) {
				setTimeout(() => this.nextPassage(), 1000);
			}
		};
		
		audio.play();
		playBtn.textContent = '⏸️';
	  }

	  redoCurrentPassage() {
		const newSeed = Math.floor(Math.random() * 10000);
		this.playCurrentPassage(newSeed);
	  }

	  nextPassage() {
		  if (this.currentIndex < this.currentPassages.length - 1) {
			this.currentIndex++;
			this.playCurrentPassage();
		  }
	  }

	  previousPassage() {
		  if (this.currentIndex > 0) {
			this.currentIndex--;
			this.playCurrentPassage();
		  }
	  }

	  toggleAutoPlay() {
		  this.autoPlay = !this.autoPlay;
		  const btn = document.getElementById('auto-play-btn');
		  btn.classList.toggle('active', this.autoPlay);
	  }

	  // Music Player Methods
	  playTrack(trackId) {
	    const tracks = {
	  	'gentle-streams': {
	  	  title: 'Gentle Streams',
	  	  description: 'Soft piano with nature sounds',
	  	  icon: '🌊',
	  	  url: 'https://www.dailygrace.online/audio/GentleStreams.mp3',
	  	  duration: 289 // 4:49 in seconds
	  	},
	  	'heavenly-peace': {
	  	  title: 'Heavenly Peace',
	  	  description: 'Ambient choir and strings',
	  	  icon: '☁️',
	  	  url: 'https://www.dailygrace.online/audio/HeavenlyPeace.mp3',
	  	  duration: 239 // 3:59 in seconds
	  	},
	  	'morning-light': {
	  	  title: 'Morning Light',
	  	  description: 'Uplifting acoustic guitar',
	  	  icon: '🌅',
	  	  url: 'https://www.dailygrace.online/audio/MorningLight.mp3',
	  	  duration: 240 // 4:00 in seconds
	  	},
	  	'quiet-sanctuary': {
	  	  title: 'Quiet Sanctuary',
	  	  description: 'Meditative bells and pads',
	  	  icon: '🕊️',
	  	  url: 'https://www.dailygrace.online/audio/QuietSanctuary.mp3',
	  	  duration: 202 // 3:22 in seconds
	  	},
		'sacred-waters': {
		  title: 'Sacred Waters',
		  description: 'Flowing water with gentle harp',
		  icon: '💧',
		  url: 'https://www.dailygrace.online/audio/SacredWaters.mp3',
		  duration: 169 // 2:49 in seconds
		},
		'peaceful-garden': {
		  title: 'Peaceful Garden',
		  description: 'Nature sounds with soft flute',
		  icon: '🌿',
		  url: 'https://www.dailygrace.online/audio/PeacefulGarden.mp3',
		  duration: 248 // 4:08 in seconds
		},
		'rest-in-his-presence': {
		  title: 'Rest in His Presence',
		  description: 'Finding peace in God\'s embrace',
		  icon: '🙏',
		  url: 'https://www.dailygrace.online/audio/RestinHisPresence.mp3',
		  duration: 240
		},
		'morning-mercies': {
		  title: 'Morning Mercies',
		  description: 'God\'s faithfulness each new day',
		  icon: '🌅',
		  url: 'https://www.dailygrace.online/audio/MorningMercies.mp3',
		  duration: 225
		},
		'healing-waters': {
		  title: 'Healing Waters',
		  description: 'Restoration for the soul',
		  icon: '💧',
		  url: 'https://www.dailygrace.online/audio/HealingWaters.mp3',
		  duration: 255
		},
		'abide-in-me': {
		  title: 'Abide in Me',
		  description: 'Dwelling in Christ\'s love',
		  icon: '🌿',
		  url: 'https://www.dailygrace.online/audio/AbideinMe.mp3',
		  duration: 210
		},
		'peace-be-still': {
		  title: 'Peace Be Still',
		  description: 'Calm in life\'s storms',
		  icon: '🕊️',
		  url: 'https://www.dailygrace.online/audio/PeaceBeStill.mp3',
		  duration: 270
		},
		'come-away-with-me': {
		  title: 'Come Away With Me',
		  description: 'Jesus\' gentle invitation',
		  icon: '✨',
		  url: 'https://www.dailygrace.online/audio/ComeAwayWithMe.mp3',
		  duration: 230
		}				
	    };
	  
	    this.currentTrack = tracks[trackId];
	    this.isLooping = false;
	    this.timerMinutes = 0;
	    this.timerInterval = null;
	  
	    // Update UI
	    document.getElementById('current-track-icon').textContent = this.currentTrack.icon;
	    document.getElementById('current-track-title').textContent = this.currentTrack.title;
	    document.getElementById('current-track-description').textContent = this.currentTrack.description;
	    document.getElementById('total-time').textContent = this.formatTime(this.currentTrack.duration);
	  
	    // Setup audio
	    const audio = document.getElementById('music-audio');
	    audio.src = this.currentTrack.url;
	    audio.loop = false;
	  
	    // Show modal
	    document.getElementById('music-player-modal').classList.add('active');
	  
	    // Setup listeners
	    this.setupMusicListeners();
	  }
	  
	  setupMusicListeners() {
	    const audio = document.getElementById('music-audio');
	    
	    audio.addEventListener('timeupdate', () => {
	  	if (audio.duration) {
	  	  const progress = (audio.currentTime / audio.duration) * 100;
	  	  document.getElementById('music-progress').style.width = `${progress}%`;
	  	  document.getElementById('current-time').textContent = this.formatTime(audio.currentTime);
	  	}
	    });
	  
	    audio.addEventListener('ended', () => {
	  	if (!this.isLooping) {
	  	  document.getElementById('play-pause-btn').textContent = '▶️';
	  	}
	    });
	  }
	  
	  togglePlayPause() {
	    const audio = document.getElementById('music-audio');
	    const btn = document.getElementById('play-pause-btn');
	  
	    if (audio.paused) {
	  	audio.play();
	  	btn.textContent = '⏸️';
	    } else {
	  	audio.pause();
	  	btn.textContent = '▶️';
	    }
	  }
	  
	  toggleLoop() {
	    const audio = document.getElementById('music-audio');
	    const btn = document.getElementById('loop-btn');
	  
	    this.isLooping = !this.isLooping;
	    audio.loop = this.isLooping;
	    btn.classList.toggle('active', this.isLooping);
	  }
	  
	  showTimer() {
	    const timerSection = document.getElementById('timer-section');
	    timerSection.classList.toggle('hidden');
	  }
	  
	  setTimer(minutes) {
	    this.timerMinutes = minutes;
	    this.startTimer();
	    document.getElementById('timer-display').classList.remove('hidden');
	    this.updateTimerDisplay();
	  }
	  
	  startTimer() {
	    if (this.timerInterval) clearInterval(this.timerInterval);
	    
	    let seconds = this.timerMinutes * 60;
	    
	    this.timerInterval = setInterval(() => {
	  	seconds--;
	  	
	  	if (seconds <= 0) {
	  	  this.fadeOutAndStop();
	  	  clearInterval(this.timerInterval);
	  	  this.timerInterval = null;
	  	} else {
	  	  const mins = Math.floor(seconds / 60);
	  	  const secs = seconds % 60;
	  	  document.getElementById('timer-countdown').textContent = 
	  		`${mins}:${secs.toString().padStart(2, '0')}`;
	  	}
	    }, 1000);
	  }
	  
	  updateTimerDisplay() {
	    document.getElementById('timer-countdown').textContent = `${this.timerMinutes}:00`;
	  }
	  
	  cancelTimer() {
	    if (this.timerInterval) {
	  	clearInterval(this.timerInterval);
	  	this.timerInterval = null;
	    }
	    document.getElementById('timer-display').classList.add('hidden');
	  }
	  
	  fadeOutAndStop() {
	    const audio = document.getElementById('music-audio');
	    const fadeInterval = setInterval(() => {
	  	if (audio.volume > 0.1) {
	  	  audio.volume -= 0.1;
	  	} else {
	  	  audio.pause();
	  	  audio.volume = 1.0;
	  	  clearInterval(fadeInterval);
	  	  this.closeMusicPlayer();
	  	}
	    }, 200);
	  }
	  
	  seekTrack(event) {
	    const audio = document.getElementById('music-audio');
	    if (!audio.duration) return;
	  
	    const progressContainer = event.currentTarget;
	    const clickX = event.offsetX;
	    const width = progressContainer.offsetWidth;
	    const percentage = clickX / width;
	  
	    audio.currentTime = percentage * audio.duration;
	  }
	  
	  closeMusicPlayer() {
	    const audio = document.getElementById('music-audio');
	    audio.pause();
	    audio.src = '';
	    
	    if (this.timerInterval) {
	  	clearInterval(this.timerInterval);
	  	this.timerInterval = null;
	    }
	    
	    document.getElementById('music-player-modal').classList.remove('active');
	    document.getElementById('timer-section').classList.add('hidden');
	    document.getElementById('timer-display').classList.add('hidden');
	  }

      // Time-based Features
      updateTimeGreeting() {
        const hour = new Date().getHours();
        const greetingEl = document.getElementById('time-greeting');
        const messageEl = document.getElementById('time-message');
        
        let greeting, message;
        
        if (hour < 6) {
          greeting = "🌙 Peace Be With You";
          message = "In the quiet of the night, His presence surrounds you";
        } else if (hour < 12) {
          greeting = "🌅 Good Morning, Beloved";
          message = "His mercies are new every morning";
        } else if (hour < 17) {
          greeting = "☀️ Blessed Afternoon";
          message = "May His strength sustain you through the day";
        } else if (hour < 21) {
          greeting = "🌇 Evening Blessings";
          message = "Rest in His faithfulness as the day ends";
        } else {
          greeting = "🌙 Peaceful Night";
          message = "May His peace guard your heart through the night";
        }
        
        greetingEl.textContent = greeting;
        messageEl.textContent = message;
      }

      getTimeContext() {
        const hour = new Date().getHours();
        if (hour < 6) return "late night reflection, rest, trust";
        if (hour < 12) return "morning devotion, new beginnings, gratitude";
        if (hour < 17) return "midday meditation, perseverance, strength";
        if (hour < 21) return "evening reflection, thanksgiving, peace";
        return "nighttime prayer, rest, protection";
      }

      // Daily Verse
	  async loadDailyVerse() {
	    const verseContainer = document.getElementById('daily-verse');
	    const seed = new Date().toDateString();
	    
	    try {
	  	const prompt = `Generate a brief, encouraging Bible verse for today. Include the verse reference. Keep it under 50 words. Focus on comfort, hope, or strength. Output only the verse and reference, no commentary.`;
	  	
	  	const response = await fetch(`https://text.pollinations.ai/${encodeURIComponent(prompt)}?model=openai&seed=${seed.hashCode()}`);
	  	const text = await response.text();
	  	
	  	const parts = text.match(/(.+?):\s*"([^"]+)"/);
	  	if (parts) {
	  	  verseContainer.innerHTML = `
	  		<p class="scripture-reference">${parts[1]}</p>
	  		<p class="devotion-text">"${parts[2]}"</p>
	  	  `;
	  	} else {
	  	  verseContainer.innerHTML = `<p class="devotion-text">${text}</p>`;
	  	}
	    } catch (error) {
	  	console.error('Failed to load daily verse:', error);
	    }
	  }
      
	

      // Navigation
	  showSection(sectionName) {
		// Hide all sections
		document.querySelectorAll('.section').forEach(section => {
			section.classList.remove('active');
		});
		
		// Show selected section
		document.getElementById(`${sectionName}-section`).classList.add('active');
		this.currentSection = sectionName;
		
		// Load section-specific content
		if (sectionName === 'history') {
			this.loadHistory();
		} else if (sectionName === 'prayers') {
			this.loadSavedPrayers();
		} else if (sectionName === 'devotions') {
			this.loadLatestDevotion();
		} else if (sectionName === 'bible') {
			this.loadBibleBooks();
		} else if (sectionName === 'guidance') {
		  this.loadGuidanceHistory();			
		}
	  }

	  async loadLatestDevotion() {
	    const devotions = await this.getAllContent('devotion');
	    
	    if (devotions.length > 0) {
	  	// Display the most recent devotion
	  	const latestDevotion = devotions[0];
	  	this.displayDevotion(latestDevotion);
	  	this.preloadAudio(latestDevotion);
	  	
	  	// Show recent devotions below if there are more
	  	if (devotions.length > 1) {
	  	  this.displayRecentDevotions(devotions.slice(1, 5));
	  	}
	  	
	  	// Show the "New Devotion" button since devotions exist
	  	document.querySelector('.text-center.mt-2').style.display = 'block';
	  	
	    } else {
	  	// No devotions yet, show welcome message with create button
	  	document.getElementById('devotion-container').innerHTML = `
	  	  <div class="devotion-card" style="text-align: center; padding: 3rem;">
	  		<h2 style="color: var(--deep-navy); margin-bottom: 1rem;">Welcome to Your Devotions</h2>
	  		<p style="font-size: 1.1rem; margin-bottom: 2rem;">
	  		  Begin your spiritual journey with a personalized devotion created just for you.
	  		</p>
	  		<button class="btn btn-primary" onclick="app.createNewDevotion()" style="font-size: 1.1rem;">
	  		  🌅 Create Your First Devotion
	  		</button>
	  	  </div>
	  	`;
	  	
	  	// Hide the "New Devotion" button since no devotions exist yet
	  	document.querySelector('.text-center.mt-2').style.display = 'none';
	    }
	  }
	  
	  displayRecentDevotions(devotions) {
	  	let recentSection = document.getElementById('recent-devotions');
	  	
	  	if (!recentSection) {
	  		// Create the section if it doesn't exist
	  		const devotionSection = document.getElementById('devotions-section');
	  		const recentHTML = `
	  			<div id="recent-devotions" style="margin-top: 3rem;">
	  				<h3 style="text-align: center; margin-bottom: 2rem;">Recent Devotions</h3>
	  				<div class="history-grid" id="recent-devotions-grid"></div>
	  			</div>
	  		`;
	  		devotionSection.insertAdjacentHTML('beforeend', recentHTML);
	  		recentSection = document.getElementById('recent-devotions');
	  	}
	  	
	  	const grid = document.getElementById('recent-devotions-grid');
	  	grid.innerHTML = devotions.map(devotion => `
	  		<div class="history-item" onclick="app.updateCurrentDevotion(${devotion.id})">
	  			<span class="history-item-type">Devotion</span>
	  			<h4 class="history-item-title">${devotion.topic}</h4>
	  			<p class="history-item-date">${new Date(devotion.date).toLocaleDateString()}</p>
	  		</div>
	  	`).join('');
	  }
	  
	  async updateCurrentDevotion(id) {
	  	const devotion = await this.getContentById(id);
	  	this.displayDevotion(devotion);
	  	this.preloadAudio(devotion);
	  	
	  	// Scroll to top of devotion
	  	document.getElementById('devotion-container').scrollIntoView({ behavior: 'smooth' });
	  }

      // Devotion Creation
      async createNewDevotion() {
        this.showSection('devotions');
        this.showLoading('Creating your devotion...');
        
        try {
          // Generate unique topic
          const topic = await this.generateDevotionTopic();
          
          // Generate devotion content
          const content = await this.generateDevotionContent(topic);
          
          // Generate image
          const imageUrl = await this.generateDevotionImage(topic);
          
          // Save to database
          const devotion = {
            type: 'devotion',
            topic,
            content,
            imageUrl,
            date: Date.now(),
            scripture: this.extractScripture(content)
          };
          
          const id = await this.saveContent(devotion);
          devotion.id = id;
          
          // Display devotion
          this.displayDevotion(devotion);
          
          // Pre-generate audio
          this.preloadAudio(devotion);
          
        } catch (error) {
          console.error('Failed to create devotion:', error);
          this.showError('Unable to create devotion. Please try again.');
        } finally {
          this.hideLoading();
        }
      }

      async generateDevotionTopic() {
        const timeContext = this.getTimeContext();
        const recentTopics = await this.getRecentTopics();
        const avoidList = recentTopics.join(', ');
        
        const prompt = `Generate ONE unique Christian devotion topic. Context: ${timeContext}. 
        ${avoidList ? `Avoid these recent topics: ${avoidList}.` : ''} 
        Focus on: faith, hope, God's love, spiritual growth, prayer, or Biblical wisdom.
        Respond with ONLY the topic title, nothing else.`;
        
        const response = await fetch(`https://text.pollinations.ai/${encodeURIComponent(prompt)}?model=openai`);
        let topic = await response.text();
        return topic.trim().replace(/^["']|["']$/g, '');
      }

      async generateDevotionContent(topic) {
        const prompt = `Write a meaningful Christian devotion on "${topic}".
        Include: 1) An opening reflection 2) ONE relevant Bible verse naturally integrated
        3) 2-3 paragraphs of spiritual insight 4) A closing prayer or reflection question
        Length: 200-250 words. Make it personal and encouraging.`;
        
        const response = await fetch(`https://text.pollinations.ai/${encodeURIComponent(prompt)}?model=openai`);
        return await response.text();
      }

	  async generateDevotionImage(topic) {
		// First, get AI to create a visual description
		const descriptionPrompt = `Create a visual image description inspired by the Christian devotion topic: "${topic}". 
		Describe only visual elements for an artist to paint - colors, objects, scenery, lighting. 
		Do NOT include any text, words, letters, or writing in your description. 
		Keep it under 50 words. Focus on peaceful, spiritual imagery.`;
		
		const descResponse = await fetch(`https://text.pollinations.ai/${encodeURIComponent(descriptionPrompt)}?model=openai`);
		let visualDescription = await descResponse.text();
		
		// Clean up the description - remove quotes and trim
		visualDescription = visualDescription.replace(/^["']|["']$/g, '').trim();
		
		// Now use that description for the image
		const seed = Date.now();
		return `https://image.pollinations.ai/prompt/${encodeURIComponent(visualDescription)}?model=flux&width=1200&height=675&seed=${seed}&nologo=true`;
	  }

      displayDevotion(devotion) {
        const container = document.getElementById('devotion-container');
        container.innerHTML = `
          <div class="devotion-card">
			<div class="devotion-header">
              <h3>${devotion.topic}</h3>
              <span class="devotion-date">${new Date(devotion.date).toLocaleDateString()}</span>
            </div>
            
            <img src="${devotion.imageUrl}" alt="${devotion.topic}" class="devotion-image" />
            
            <div class="devotion-content">
              <p class="devotion-text">${devotion.content}</p>
            </div>
            
            <div class="audio-player" id="devotion-audio-${devotion.id}">
              <div class="audio-controls">
                <button class="play-button" onclick="app.toggleAudio(${devotion.id}, 'devotion')">▶️</button>
                <div class="progress-container" onclick="app.seekAudio(event, ${devotion.id})">
                  <div class="progress-bar" id="progress-${devotion.id}"></div>
                </div>
                <span class="time-display" id="time-${devotion.id}">0:00 / 0:00</span>
              </div>
              <audio id="audio-${devotion.id}" preload="none"></audio>
            </div>
          </div>
        `;
      }

	  // Spiritual Guidance Methods
	  async seekGuidance() {
	    const userInput = document.getElementById('guidance-input').value.trim();
	    
	    if (!userInput) {
	  	this.showError('Please share what\'s on your heart first');
	  	return;
	    }
	    
	    // Add user message to chat
	    this.addChatMessage(userInput, 'user');
	    
	    // Clear input and show typing indicator
	    document.getElementById('guidance-input').value = '';
	    this.showTypingIndicator();
	    
	    try {
	  	const prompt = `You are a compassionate Christian spiritual companion. Someone has shared: "${userInput}" Respond with: 1. Gentle acknowledgment of their situation 2. Relevant Bible verse(s) that speak to their need 3. Biblical wisdom and encouragement (not personal advice) 4. A brief, loving prayer or blessing Keep it warm, conversational, and Christ-centered. About 200-250 words. Focus on God's love, grace, and truth rather than giving direct personal advice.`;
	  	
	  	const response = await fetch(`https://text.pollinations.ai/${encodeURIComponent(prompt)}?model=openai`);
	  	const guidanceText = await response.text();
	  	
	  	// Remove typing indicator and add bot response
	  	this.hideTypingIndicator();
	  	this.addChatMessage(guidanceText, 'bot');
	  	
	  	// Save the session
	  	const guidance = {
	  	  type: 'guidance',
	  	  question: userInput,
	  	  response: guidanceText,
	  	  date: Date.now(),
	  	  title: this.generateGuidanceTitle(userInput)
	  	};
	  	
	  	await this.saveContent(guidance);
	  	this.loadGuidanceHistory();
	  	
	    } catch (error) {
	  	this.hideTypingIndicator();
	  	this.addChatMessage('I apologize, but I\'m having trouble responding right now. Please try again in a moment.', 'bot');
	  	console.error('Failed to get guidance:', error);
	    }
	  }
	  
	  addChatMessage(content, sender) {
		  const messagesContainer = document.getElementById('chat-messages');
		  const messageDiv = document.createElement('div');
		  messageDiv.className = `message ${sender}-message`;
		  
		  const contentDiv = document.createElement('div');
		  contentDiv.className = 'message-content';
		  contentDiv.innerHTML = `<p>${content}</p>`;
		  
		  messageDiv.appendChild(contentDiv);
		  
		  // Add audio controls for bot messages
		  if (sender === 'bot') {
			const actionsDiv = document.createElement('div');
			actionsDiv.className = 'message-actions';
			const audioId = `msg-audio-${Date.now()}`;
			
			// Properly escape the content for JavaScript
			const escapedContent = content
			  .replace(/\\/g, '\\\\')
			  .replace(/'/g, "\\'")
			  .replace(/"/g, '\\"')
			  .replace(/\n/g, '\\n')
			  .replace(/\r/g, '\\r')
			  .replace(/\t/g, '\\t');
			
			actionsDiv.innerHTML = `
			  <button class="message-action-btn play-btn" onclick="app.toggleMessageAudio('${audioId}', '${escapedContent}', this)">
				▶️ Listen
			  </button>
			  <button class="message-action-btn" onclick="app.regenerateMessageAudio('${audioId}', '${escapedContent}')">
				🔁 Regenerate
			  </button>
			  <audio id="${audioId}" preload="none"></audio>
			`;
			messageDiv.appendChild(actionsDiv);
		  }
		  
		  messagesContainer.appendChild(messageDiv);
		  
		  // Scroll to bottom
		  messagesContainer.scrollTop = messagesContainer.scrollHeight;
	  }

	  async toggleMessageAudio(audioId, text, buttonElement) {
	    const audio = document.getElementById(audioId);
	    
	    // If audio is playing, pause it
	    if (!audio.paused) {
	  	audio.pause();
	  	buttonElement.innerHTML = '▶️ Listen';
	  	return;
	    }
	    
	    // If no source, generate it first
	    if (!audio.src) {
	  	await this.generateMessageAudio(audioId, text);
	    }
	    
	    // Stop any other playing message audio
	    document.querySelectorAll('[id^="msg-audio-"]').forEach(otherAudio => {
	  	if (otherAudio !== audio && !otherAudio.paused) {
	  	  otherAudio.pause();
	  	  const otherButton = otherAudio.parentElement.querySelector('.play-btn');
	  	  if (otherButton) otherButton.innerHTML = '▶️ Listen';
	  	}
	    });
	    
	    // Play this audio
	    try {
	  	await audio.play();
	  	buttonElement.innerHTML = '⏸️ Pause';
	  	
	  	// Setup event listeners
	  	audio.onended = () => {
	  	  buttonElement.innerHTML = '▶️ Listen';
	  	};
	  	
	  	audio.onerror = () => {
	  	  buttonElement.innerHTML = '❌ Error';
	  	  setTimeout(() => {
	  		buttonElement.innerHTML = '▶️ Listen';
	  	  }, 2000);
	  	};
	  	
	    } catch (error) {
	  	console.error('Audio play failed:', error);
	  	buttonElement.innerHTML = '❌ Failed';
	  	setTimeout(() => {
	  	  buttonElement.innerHTML = '▶️ Listen';
	  	}, 2000);
	    }
	  }
	  
	  async generateMessageAudio(audioId, text) {
	    const audio = document.getElementById(audioId);
	    
	    let cleanText = text
	  	.replace(/\n/g, ' ')
	  	.replace(/\s+/g, ' ')
	  	.replace(/([.!?])\s+/g, '$1\n')
	  	.trim();
	    
	    const transcriptionInstruction = "READ THIS TEXT VERBATIM WITHOUT ANY COMMENTARY OR RESPONSE:";
	    const textToRead = transcriptionInstruction + " " + cleanText;
	    
	    const seed = Math.floor(Math.random() * 10000);
	    const encodedText = encodeURIComponent(textToRead);
	    const audioUrl = `https://text.pollinations.ai/${encodedText}?model=openai-audio&voice=nova&seed=${seed}`;
	    
	    audio.src = audioUrl;
	    return audioUrl;
	  }
	  
	  async regenerateMessageAudio(audioId, text) {
	    const audio = document.getElementById(audioId);
	    const playButton = audio.parentElement.querySelector('.play-btn');
	    
	    // Stop current audio if playing
	    if (!audio.paused) {
	  	audio.pause();
	  	playButton.innerHTML = '▶️ Listen';
	    }
	    
	    // Show regenerating status
	    const regenerateBtn = event.target;
	    const originalText = regenerateBtn.innerHTML;
	    regenerateBtn.innerHTML = '🔄 Regenerating...';
	    regenerateBtn.disabled = true;
	    
	    try {
	  	// Generate new audio with different seed
	  	await this.generateMessageAudio(audioId, text);
	  	
	  	// Reset button
	  	regenerateBtn.innerHTML = originalText;
	  	regenerateBtn.disabled = false;
	  	
	    } catch (error) {
	  	regenerateBtn.innerHTML = '❌ Failed';
	  	setTimeout(() => {
	  	  regenerateBtn.innerHTML = originalText;
	  	  regenerateBtn.disabled = false;
	  	}, 2000);
	    }
	  }
	  
	  showTypingIndicator() {
	    const messagesContainer = document.getElementById('chat-messages');
	    const typingDiv = document.createElement('div');
	    typingDiv.className = 'typing-indicator';
	    typingDiv.id = 'typing-indicator';
	    typingDiv.innerHTML = `
	  	<span>Seeking biblical wisdom</span>
	  	<div class="typing-dots">
	  	  <div class="typing-dot"></div>
	  	  <div class="typing-dot"></div>
	  	  <div class="typing-dot"></div>
	  	</div>
	    `;
	    
	    messagesContainer.appendChild(typingDiv);
	    messagesContainer.scrollTop = messagesContainer.scrollHeight;
	  }
	  
	  hideTypingIndicator() {
	    const typingIndicator = document.getElementById('typing-indicator');
	    if (typingIndicator) {
	  	typingIndicator.remove();
	    }
	  }
	  
	  async playMessageAudio(text) {
	    let cleanText = text
	  	.replace(/\n/g, ' ')
	  	.replace(/\s+/g, ' ')
	  	.replace(/([.!?])\s+/g, '$1\n')
	  	.trim();
	    
	    const transcriptionInstruction = "READ THIS TEXT VERBATIM WITHOUT ANY COMMENTARY OR RESPONSE:";
	    const textToRead = transcriptionInstruction + " " + cleanText;
	    
	    const encodedText = encodeURIComponent(textToRead);
	    const audioUrl = `https://text.pollinations.ai/${encodedText}?model=openai-audio&voice=nova`;
	    
	    const tempAudio = new Audio(audioUrl);
	    tempAudio.play();
	  }

	  displayGuidanceResponse(text) {
		  const responseDiv = document.getElementById('guidance-response');
		  const contentDiv = document.getElementById('guidance-content');
		  const dateSpan = document.getElementById('guidance-date');
		  
		  contentDiv.textContent = text;
		  dateSpan.textContent = new Date().toLocaleString();
		  responseDiv.style.display = 'block';
		  
		  // Scroll to response
		  responseDiv.scrollIntoView({ behavior: 'smooth' });
	  }

	  async listenToGuidance() {
		  if (!this.currentGuidanceResponse) {
			this.showError('No guidance to listen to');
			return;
		  }
		  
		  this.showLoading('Preparing audio...');
		  
		  try {
			let cleanText = this.currentGuidanceResponse
			  .replace(/\n/g, ' ')
			  .replace(/\s+/g, ' ')
			  .replace(/([.!?])\s+/g, '$1\n')
			  .trim();
			
			const transcriptionInstruction = "READ THIS TEXT VERBATIM WITHOUT ANY COMMENTARY OR RESPONSE:";
			const textToRead = transcriptionInstruction + " " + cleanText;
			
			const encodedText = encodeURIComponent(textToRead);
			const audioUrl = `https://text.pollinations.ai/${encodedText}?model=openai-audio&voice=nova`;
			
			const tempAudio = new Audio(audioUrl);
			tempAudio.play();
			
			this.hideLoading();
		  } catch (error) {
			this.showError('Unable to create audio');
			this.hideLoading();
		  }
	  }

	  generateGuidanceTitle(text) {
		  const words = text.split(' ').slice(0, 6).join(' ');
		  return words + (text.split(' ').length > 6 ? '...' : '');
	  }

	  async loadGuidanceHistory() {
		  const guidanceSessions = await this.getAllContent('guidance');
		  const container = document.getElementById('guidance-history');
		  
		  if (guidanceSessions.length === 0) {
			document.getElementById('guidance-history-section').style.display = 'none';
			return;
		  }
		  
		  document.getElementById('guidance-history-section').style.display = 'block';
		  
		  container.innerHTML = guidanceSessions.slice(0, 6).map(session => `
			<div class="history-item" onclick="app.showGuidanceDetail(${session.id})">
			  <button class="delete-button" onclick="event.stopPropagation(); app.deleteItem(${session.id})">×</button>
			  <span class="history-item-type">Guidance</span>
			  <h4 class="history-item-title">${session.title}</h4>
			  <p class="history-item-date">${new Date(session.date).toLocaleDateString()}</p>
			</div>
		  `).join('');
	  }

	  async showGuidanceDetail(id) {
	    const session = await this.getContentById(id);
	    const modal = document.getElementById('detail-modal');
	    const modalBody = document.getElementById('modal-body');
	    
	    modalBody.innerHTML = `
	  	<div class="guidance-interface">
	  	  <h3>Spiritual Guidance Session</h3>
	  	  <p class="devotion-date">${new Date(session.date).toLocaleDateString()}</p>
	  	  
	  	  <div style="margin: 1.5rem 0;">
	  		<h4 style="color: var(--sage-green); margin-bottom: 0.5rem;">What you shared:</h4>
	  		<p style="background: var(--warm-cream); padding: 1rem; border-radius: 8px; font-style: italic;">
	  		  "${session.question}"
	  		</p>
	  	  </div>
	  	  
	  	  <div>
	  		<h4 style="color: var(--sage-green); margin-bottom: 0.5rem;">Biblical encouragement:</h4>
	  		<div class="response-content">${session.response}</div>
	  	  </div>
	  	  
	  	  <button class="btn btn-accent mt-2" onclick="app.playGuidanceAudio(\`${session.response.replace(/`/g, '\\`').replace(/\$/g, '\\$')}\`)">
	  		🎧 Listen to Response
	  	  </button>
	  	</div>
	    `;
	    
	    modal.classList.add('active');
	  }
	  
	  async playGuidanceAudio(text) {
	    let cleanText = text
	  	.replace(/\n/g, ' ')
	  	.replace(/\s+/g, ' ')
	  	.replace(/([.!?])\s+/g, '$1\n')
	  	.trim();
	    
	    const transcriptionInstruction = "READ THIS TEXT VERBATIM WITHOUT ANY COMMENTARY OR RESPONSE:";
	    const textToRead = transcriptionInstruction + " " + cleanText;
	    
	    const encodedText = encodeURIComponent(textToRead);
	    const audioUrl = `https://text.pollinations.ai/${encodedText}?model=openai-audio&voice=nova`;
	    
	    const tempAudio = new Audio(audioUrl);
	    tempAudio.play();
	  }

	  // Audio Management 
      async preloadAudio(item) {
          try {
              // Clean up text - normalize spaces, etc.
              let cleanText = `${item.topic}. ${item.content}`
                  .replace(/\n/g, ' ') // Replace newlines with spaces
                  .replace(/\s+/g, ' ') // Normalize spaces
                  .replace(/([.!?])\s+/g, '$1\n') // Add breaks after sentences
                  .trim();
              
              // Prepare the instruction with EXACT same format as working code
              const transcriptionInstruction = "READ THIS TEXT VERBATIM WITHOUT ANY COMMENTARY OR RESPONSE:";
              const textToRead = transcriptionInstruction + " " + cleanText;
              
              // Generate the audio URL (using the method from working script)
              const encodedText = encodeURIComponent(textToRead);
              const audioUrl = `https://text.pollinations.ai/${encodedText}?model=openai-audio&voice=nova`;
              
              // Set the audio source
              const audio = document.getElementById(`audio-${item.id}`);
              if (audio) {
                  audio.src = audioUrl;
              }
          } catch (error) {
              console.error('Failed to generate audio:', error);
          }
      }
   
	  async toggleAudio(id, type) {
	  	// Pause radio if playing
	  	if (this.isRadioPlaying && this.radioAudio && !this.radioAudio.paused) {
	  		this.radioAudio.pause();
	  		document.getElementById('radio-play-btn').textContent = '▶️';
	  	}
	  	
	  	const audio = document.getElementById(`audio-${id}`);
	  	const playBtn = event.target;
	  	
	  	if (!audio.src) {
	  		const item = await this.getContentById(id);
	  		await this.preloadAudio(item);
	  	}
	  	
	  	if (this.currentAudio && this.currentAudio !== audio) {
	  		this.currentAudio.pause();
	  		this.currentAudio.parentElement.querySelector('.play-button').textContent = '▶️';
	  	}
	  	
	  	if (audio.paused) {
	  		audio.play();
	  		playBtn.textContent = '⏸️';
	  		this.currentAudio = audio;
	  		this.setupAudioListeners(audio, id);
	  	} else {
	  		audio.pause();
	  		playBtn.textContent = '▶️';
	  	}
	  }

      setupAudioListeners(audio, id) {
        const progressBar = document.getElementById(`progress-${id}`);
        const timeDisplay = document.getElementById(`time-${id}`);
        
        audio.addEventListener('timeupdate', () => {
          if (audio.duration) {
            const progress = (audio.currentTime / audio.duration) * 100;
            progressBar.style.width = `${progress}%`;
            timeDisplay.textContent = `${this.formatTime(audio.currentTime)} / ${this.formatTime(audio.duration)}`;
          }
        });
        
        audio.addEventListener('ended', () => {
          audio.parentElement.querySelector('.play-button').textContent = '▶️';
          progressBar.style.width = '0%';
        });
      }

      seekAudio(event, id) {
        const audio = document.getElementById(`audio-${id}`);
        if (!audio.duration) return;
        
        const progressContainer = event.currentTarget;
        const clickX = event.offsetX;
        const width = progressContainer.offsetWidth;
        const percentage = clickX / width;
        
        audio.currentTime = percentage * audio.duration;
      }

      formatTime(seconds) {
        if (isNaN(seconds)) return '0:00';
        const mins = Math.floor(seconds / 60);
        const secs = Math.floor(seconds % 60);
        return `${mins}:${secs.toString().padStart(2, '0')}`;
      }

      // Prayer Features
      showPrayerCreator() {
          document.getElementById('prayer-request-input').value = '';
          document.getElementById('prayer-input').value = '';
          document.getElementById('prayer-creator').scrollIntoView({ behavior: 'smooth' });
      }

      async savePrayer() {
        const prayerText = document.getElementById('prayer-input').value.trim();
        if (!prayerText) {
          this.showError('Please write your prayer first');
          return;
        }
        
        const prayer = {
          type: 'prayer',
          content: prayerText,
          date: Date.now(),
          title: this.generatePrayerTitle(prayerText)
        };
        
        await this.saveContent(prayer);
        document.getElementById('prayer-input').value = '';
        this.showSuccess('Prayer saved! 🙏');
        this.loadSavedPrayers();
      }

      generatePrayerTitle(text) {
        const words = text.split(' ').slice(0, 5).join(' ');
        return words + (text.split(' ').length > 5 ? '...' : '');
      }

      async requestPrayerHelp() {
          const userRequest = document.getElementById('prayer-request-input').value.trim();
          
          if (!userRequest) {
              this.showError('Please share what you would like to pray about first');
              return;
          }
          
          this.showLoading('Creating a prayer based on your request...');
          
          try {
              const context = this.getTimeContext();
              
              const prompt = `The user wants to pray about: "${userRequest}". 
              Based on this specific request, write a heartfelt Christian prayer that directly addresses their needs. 
              Make it personal, sincere, and about 150-200 words. 
              Include their specific concerns while adding appropriate scripture, gratitude, and trust in God's plan.
              Context: ${context}`;
              
              const response = await fetch(`https://text.pollinations.ai/${encodeURIComponent(prompt)}?model=openai`);
              const prayerText = await response.text();
              
              // Put the generated prayer in the main prayer textarea
              document.getElementById('prayer-input').value = prayerText;
              
              // Optionally clear the request field
              // document.getElementById('prayer-request-input').value = '';
              
              this.showSuccess('Prayer created! Feel free to modify it as you wish.');
              
              // Auto-resize the prayer textarea to fit content
              const prayerTextarea = document.getElementById('prayer-input');
              prayerTextarea.style.height = 'auto';
              prayerTextarea.style.height = Math.max(300, prayerTextarea.scrollHeight) + 'px';
              
          } catch (error) {
              this.showError('Unable to generate prayer suggestion');
          } finally {
              this.hideLoading();
          }
      }

      async listenToPrayer() {
          const prayerText = document.getElementById('prayer-input').value.trim();
          if (!prayerText) {
              this.showError('Please write a prayer first');
              return;
          }
          
          this.showLoading('Preparing audio...');
          
          try {
              // Clean up text
              let cleanText = prayerText
                  .replace(/\n/g, ' ')
                  .replace(/\s+/g, ' ')
                  .replace(/([.!?])\s+/g, '$1\n')
                  .trim();
              
              // Use the EXACT same format as the working transcribe.html
              const transcriptionInstruction = "READ THIS TEXT VERBATIM WITHOUT ANY COMMENTARY OR RESPONSE:";
              const textToRead = transcriptionInstruction + " " + cleanText;
              
              const encodedText = encodeURIComponent(textToRead);
              const audioUrl = `https://text.pollinations.ai/${encodedText}?model=openai-audio&voice=nova`;
              
              // Create temporary audio player
              const tempAudio = new Audio(audioUrl);
              tempAudio.play();
              
              this.hideLoading();
          } catch (error) {
              this.showError('Unable to create audio');
              this.hideLoading();
          }
      }

      async loadSavedPrayers() {
          const prayers = await this.getAllContent('prayer');
          const container = document.getElementById('saved-prayers');
          
          if (prayers.length === 0) {
              container.innerHTML = '<p class="text-center">No saved prayers yet. Write your first prayer above!</p>';
              return;
          }
          
          container.innerHTML = prayers.map(prayer => `
              <div class="history-item" onclick="app.showDetail(${prayer.id})">
                  <button class="delete-button" onclick="event.stopPropagation(); app.deleteItem(${prayer.id})">×</button>
                  <span class="history-item-type">Prayer</span>
                  <h4 class="history-item-title">${prayer.title}</h4>
                  <p class="history-item-date">${new Date(prayer.date).toLocaleDateString()}</p>
              </div>
          `).join('');
      }

      // History Management
      async loadHistory() {
          const content = await this.getAllContent(this.currentFilter === 'all' ? null : this.currentFilter);
          const container = document.getElementById('history-container');
          
          if (content.length === 0) {
              container.innerHTML = '<p class="text-center">No content yet. Start your spiritual journey today!</p>';
              return;
          }
          
          container.innerHTML = content.map(item => `
              <div class="history-item" onclick="app.showDetail(${item.id})">
                  <button class="delete-button" onclick="event.stopPropagation(); app.deleteItem(${item.id})">×</button>
                  <span class="history-item-type">${item.type === 'devotion' ? 'Devotion' : 'Prayer'}</span>
                  <h4 class="history-item-title">${item.topic || item.title}</h4>
                  <p class="history-item-date">${new Date(item.date).toLocaleDateString()}</p>
              </div>
          `).join('');
      }

	  async deleteItem(id) {
	  	// Store the ID for deletion and show custom modal
	  	this.pendingDeleteId = id;
	  	
	  	// Get the item to show its type in the modal
	  	const item = await this.getContentById(id);
	  	const itemType = item.type === 'devotion' ? 'devotion' : 'prayer';
	  	document.getElementById('delete-item-type').textContent = itemType;
	  	
	  	// Show the custom delete modal
	  	document.getElementById('delete-modal').classList.add('active');
	  }
	  
      filterHistory(type) {
        this.currentFilter = type;
        this.loadHistory();
      }

	  cancelDelete() {
	  	this.pendingDeleteId = null;
	  	document.getElementById('delete-modal').classList.remove('active');
	  }
	  
	  async confirmDelete() {
	  	if (!this.pendingDeleteId) return;
	  	
	  	const idToDelete = this.pendingDeleteId;
	  	this.pendingDeleteId = null;
	  	
	  	// Close the delete modal
	  	document.getElementById('delete-modal').classList.remove('active');
	  	
	  	try {
	  		const transaction = this.db.transaction(['content'], 'readwrite');
	  		const store = transaction.objectStore('content');
	  		const request = store.delete(idToDelete);
	  		
	  		request.onsuccess = () => {
	  			// Refresh the current view
	  			if (this.currentSection === 'history') {
	  				this.loadHistory();
	  			} else if (this.currentSection === 'prayers') {
	  				this.loadSavedPrayers();
	  			}
	  			
	  			// If the detail modal is open for this item, close it
	  			if (document.getElementById('detail-modal').classList.contains('active')) {
	  				this.closeModal();
	  			}
	  		};
	  		
	  		request.onerror = () => {
	  			console.error('Failed to delete item');
	  		};
	  	} catch (error) {
	  		console.error('Delete error:', error);
	  	}
	  }

	  async showDetail(id) {
		   const item = await this.getContentById(id);
		   const modal = document.getElementById('detail-modal');
		   const modalBody = document.getElementById('modal-body');
		   
		   if (item.type === 'devotion') {
			   modalBody.innerHTML = `
				   <div class="devotion-card">
					   <div class="devotion-header">
						   <h3>${item.topic}</h3>
						   <span class="devotion-date">${new Date(item.date).toLocaleDateString()}</span>
					   </div>
					   
					   ${item.imageUrl ? `<img src="${item.imageUrl}" alt="${item.topic}" class="devotion-image" />` : ''}
					   
					   <div class="devotion-content">
						   <p class="devotion-text">${item.content}</p>
					   </div>
					   
					   <div class="audio-player">
						   <div class="audio-controls">
							   <button class="play-button" onclick="app.toggleAudio(${item.id}, 'devotion')">▶️</button>
							   <div class="progress-container" onclick="app.seekAudio(event, ${item.id})">
								   <div class="progress-bar" id="progress-${item.id}"></div>
							   </div>
							   <span class="time-display" id="time-${item.id}">0:00 / 0:00</span>
						   </div>
						   <audio id="audio-${item.id}" preload="none"></audio>
					   </div>
				   </div>
			   `;
		   } else if (item.type === 'guidance') {
			   modalBody.innerHTML = `
				   <div class="guidance-interface">
					   <h3>Spiritual Guidance Session</h3>
					   <p class="devotion-date">${new Date(item.date).toLocaleDateString()}</p>
					   
					   <div style="margin: 1.5rem 0;">
						   <h4 style="color: var(--sage-green); margin-bottom: 0.5rem;">What you shared:</h4>
						   <p style="background: var(--warm-cream); padding: 1rem; border-radius: 8px; font-style: italic;">
							   "${item.question}"
						   </p>
					   </div>
					   
					   <div>
						   <h4 style="color: var(--sage-green); margin-bottom: 0.5rem;">Biblical encouragement:</h4>
						   <div class="response-content">${item.response}</div>
					   </div>
					   
					   <button class="btn btn-accent mt-2" onclick="app.playGuidanceAudio(\`${item.response.replace(/`/g, '\\`').replace(/\$/g, '\\$')}\`)">
						   🎧 Listen to Response
					   </button>
				   </div>
			   `;
		   } else {
			   modalBody.innerHTML = `
				   <div class="prayer-creator">
					   <h3>Your Prayer</h3>
					   <p class="devotion-date">${new Date(item.date).toLocaleDateString()}</p>
					   <p class="devotion-text" style="margin-top: 1rem;">${item.content}</p>
					   
					   <button class="btn btn-accent mt-2" onclick="app.playPrayerAudio('${item.content}')">
						   🎧 Listen to Prayer
					   </button>
				   </div>
			   `;
		   }
		   
		   modal.classList.add('active');
	  }

      async playPrayerAudio(text) {
          // Clean up text
          let cleanText = text
              .replace(/\n/g, ' ')
              .replace(/\s+/g, ' ')
              .replace(/([.!?])\s+/g, '$1\n')
              .trim();
          
          // Use the working format
          const transcriptionInstruction = "READ THIS TEXT VERBATIM WITHOUT ANY COMMENTARY OR RESPONSE:";
          const textToRead = transcriptionInstruction + " " + cleanText;
          
          const encodedText = encodeURIComponent(textToRead);
          const audioUrl = `https://text.pollinations.ai/${encodedText}?model=openai-audio&voice=nova`;
          
          const tempAudio = new Audio(audioUrl);
          tempAudio.play();
      }

      closeModal() {
        document.getElementById('detail-modal').classList.remove('active');
      }

      // Utility Functions
      async getRecentTopics() {
        const devotions = await this.getAllContent('devotion');
        return devotions.slice(0, 5).map(d => d.topic);
      }

      extractScripture(content) {
        const scriptureMatch = content.match(/([A-Za-z]+ \d+:\d+(?:-\d+)?)/);
        return scriptureMatch ? scriptureMatch[1] : '';
      }

      showLoading(text = 'Loading...') {
        document.getElementById('loading-text').textContent = text;
        document.getElementById('loading').classList.add('active');
      }

      hideLoading() {
        document.getElementById('loading').classList.remove('active');
      }

      showError(message) {
        // Simple error display - you could enhance this with a toast notification
        alert(message);
      }

      showSuccess(message) {
        // Simple success display - you could enhance this with a toast notification
        console.log(message);
      }

	  bindEvents() {
	  	// Add keyboard shortcuts
	  	document.addEventListener('keydown', (e) => {
	  		if (e.key === 'Escape') {
	  			this.closeModal();
	  			this.cancelDelete(); // Also close delete modal
	  		}
	  	});
	  	
	  	// Close modal on background click
	  	document.getElementById('detail-modal').addEventListener('click', (e) => {
	  		if (e.target.id === 'detail-modal') {
	  			this.closeModal();
	  		}
	  	});
	  	
	  	// Close delete modal on background click
	  	document.getElementById('delete-modal').addEventListener('click', (e) => {
	  		if (e.target.id === 'delete-modal') {
	  			this.cancelDelete();
	  		}
	  	});
	  	
	  	// Auto-resize textareas
	  	const prayerInput = document.getElementById('prayer-input');
	  	const requestInput = document.getElementById('prayer-request-input');
	  	
	  	if (prayerInput) {
	  		prayerInput.addEventListener('input', function() {
	  			this.style.height = 'auto';
	  			this.style.height = Math.max(300, this.scrollHeight) + 'px';
	  		});
	  	}
	  	
	  	if (requestInput) {
	  		requestInput.addEventListener('input', function() {
	  			this.style.height = 'auto';
	  			this.style.height = Math.max(80, this.scrollHeight) + 'px';
	  		});
	  	}

		const guidanceInput = document.getElementById('guidance-input');
		if (guidanceInput) {
		  guidanceInput.addEventListener('keydown', (e) => {
			if (e.key === 'Enter' && !e.shiftKey) {
			  e.preventDefault();
			  this.seekGuidance();
			}
		  });
		}
		
	  }
    }

	// Radio Station Methods
	initRadio() {
	  	const radioElement = document.getElementById('radio-audio');
	  	if (!radioElement) {
	  		console.error('Radio audio element not found!');
	  		return;
	  	}
	  	
	  	this.radioAudio = radioElement;
	  	this.radioAudio.volume = this.radioVolume;
	  	
	  	// Setup radio audio listeners
	  	this.radioAudio.addEventListener('timeupdate', () => this.updateRadioProgress());
	  	this.radioAudio.addEventListener('ended', () => this.playNextRadioTrack());
	  	this.radioAudio.addEventListener('loadedmetadata', () => this.updateRadioDuration());
	  	
	  	// Load initial playlist
	  	this.loadRadioPlaylist('mixed');
	}
	  
	toggleRadio() {
	  	console.log('Toggle radio clicked'); // Add this
	  	const radioStation = document.getElementById('radio-station');
	  	radioStation.classList.toggle('open');
	  	
	  	// Start playing if opening for first time
	  	if (radioStation.classList.contains('open') && !this.isRadioPlaying && this.radioPlaylist.length === 0) {
	  		this.loadRadioPlaylist(this.radioStation);
	  		setTimeout(() => this.startRadio(), 500);
	  	}
	}
	  
	loadRadioPlaylist(station) {
	  	this.radioStation = station;
	  	
	  	// Define playlists
	  	const playlists = {
	  		mixed: [
	  			{ title: 'Rest in His Presence', file: 'RestinHisPresence.mp3', duration: 240 },
	  			{ title: 'Morning Mercies', file: 'MorningMercies.mp3', duration: 225 },
	  			{ title: 'Healing Waters', file: 'HealingWaters.mp3', duration: 255 },
	  			{ title: 'Abide in Me', file: 'AbideinMe.mp3', duration: 210 },
	  			{ title: 'Peace Be Still', file: 'PeaceBeStill.mp3', duration: 270 },
	  			{ title: 'Come Away With Me', file: 'ComeAwayWithMe.mp3', duration: 230 }
	  		],
	  		instrumental: [
	  			{ title: 'Gentle Streams', file: 'GentleStreams.mp3', duration: 289 },
	  			{ title: 'Heavenly Peace', file: 'HeavenlyPeace.mp3', duration: 239 },
	  			{ title: 'Morning Light', file: 'MorningLight.mp3', duration: 240 },
	  			{ title: 'Quiet Sanctuary', file: 'QuietSanctuary.mp3', duration: 202 },
	  			{ title: 'Sacred Waters', file: 'SacredWaters.mp3', duration: 169 },
	  			{ title: 'Peaceful Garden', file: 'PeacefulGarden.mp3', duration: 248 }
	  		],
	  		vocals: [
	  			{ title: 'Rest in His Presence', file: 'RestinHisPresence.mp3', duration: 240 },
	  			{ title: 'Morning Mercies', file: 'MorningMercies.mp3', duration: 225 },
	  			{ title: 'Healing Waters', file: 'HealingWaters.mp3', duration: 255 },
	  			{ title: 'Abide in Me', file: 'AbideinMe.mp3', duration: 210 },
	  			{ title: 'Peace Be Still', file: 'PeaceBeStill.mp3', duration: 270 },
	  			{ title: 'Come Away With Me', file: 'ComeAwayWithMe.mp3', duration: 230 }
	  		]
	  	};
	  	
	  	// Shuffle playlist
	  	this.radioPlaylist = this.shuffleArray([...playlists[station]]);
	  	this.radioCurrentIndex = 0;
	  	this.songsSinceCut = 0;
	  	
	  	// Update UI
	  	this.updateStationButtons(station);
	}
	  
	shuffleArray(array) {
	  	const newArray = [...array];
	  	for (let i = newArray.length - 1; i > 0; i--) {
	  		const j = Math.floor(Math.random() * (i + 1));
	  		[newArray[i], newArray[j]] = [newArray[j], newArray[i]];
	  	}
	  	return newArray;
	}
	  
	updateStationButtons(station) {
	  	document.querySelectorAll('.station-btn').forEach(btn => {
	  		btn.classList.remove('active');
	  	});
	  	
	  	const activeBtn = document.querySelector(`.station-btn[onclick*="${station}"]`);
	  	if (activeBtn) activeBtn.classList.add('active');
	}
	  
	startRadio() {
	  	if (this.radioPlaylist.length === 0) return;
	  	
	  	this.isRadioPlaying = true;
	  	this.playRadioTrack(0);
	}
	  
	playRadioTrack(index) {
	  	if (index >= this.radioPlaylist.length) {
	  		// Reshuffle and start over
	  		this.radioPlaylist = this.shuffleArray(this.radioPlaylist);
	  		index = 0;
	  	}
	  	
	  	this.radioCurrentIndex = index;
	  	
	  	// Check if we should play a cut/break
	  	if (this.songsSinceCut >= this.cutInterval) {
	  		this.playRadioCut();
	  		return;
	  	}
	  	
	  	const track = this.radioPlaylist[index];
	  	const audioPath = `/audio/${track.file}`;
	  	
	  	// Update UI
	  	document.getElementById('radio-now-playing').textContent = track.title;
	  	
	  	// Update up next
	  	const nextIndex = (index + 1) % this.radioPlaylist.length;
	  	document.getElementById('radio-up-next').textContent = this.radioPlaylist[nextIndex].title;
	  	
	  	// Play audio
	  	this.radioAudio.src = audioPath;
	  	this.radioAudio.play();
	  	document.getElementById('radio-play-btn').textContent = '⏸️';
	  	
	  	this.songsSinceCut++;
	}
	  
	playRadioCut() {
	  	// Reset cut counter
	  	this.songsSinceCut = 0;
	  	
	  	// Get appropriate cut file
	  	const cutFiles = {
	  		mixed: ['Listening_mixed-0001.mp3', 'Listening_mixed-0002.mp3', 'Listening_mixed-0003.mp3'],
	  		instrumental: ['Listening_instrumentals-0001.mp3', 'Listening_instrumentals-0002.mp3', 'Listening_instrumentals-0003.mp3'],
	  		vocals: ['Listening_vocals-0001.mp3', 'Listening_vocals-0002.mp3', 'Listening_vocals-0003.mp3']
	  	};
	  	
	  	const cuts = cutFiles[this.radioStation];
	  	const randomCut = cuts[Math.floor(Math.random() * cuts.length)];
	  	
	  	// Update UI
	  	document.getElementById('radio-now-playing').textContent = '📢 Station Announcement';
	  	
	  	// Play cut
	  	this.radioAudio.src = `/audio/cuts/${randomCut}`;
	  	this.radioAudio.play();
	  	
	  	// After cut ends, play next song
	  	this.radioAudio.onended = () => {
	  		this.radioAudio.onended = () => this.playNextRadioTrack();
	  		this.playRadioTrack(this.radioCurrentIndex);
	  	};
	}
	  
	playNextRadioTrack() {
	  	this.playRadioTrack(this.radioCurrentIndex + 1);
	}
	  
	toggleRadioPlayPause() {
	  	const btn = document.getElementById('radio-play-btn');
	  	
	  	if (this.radioAudio.paused) {
	  		this.radioAudio.play();
	  		btn.textContent = '⏸️';
	  		this.isRadioPlaying = true;
	  	} else {
	  		this.radioAudio.pause();
	  		btn.textContent = '▶️';
	  		this.isRadioPlaying = false;
	  	}
	}
	  
	skipRadioTrack() {
	  	this.playNextRadioTrack();
	}
	  
	toggleRadioMute() {
	  	const btn = document.getElementById('radio-mute-btn');
	  	
	  	if (this.radioAudio.muted) {
	  		this.radioAudio.muted = false;
	  		btn.textContent = '🔊';
	  	} else {
	  		this.radioAudio.muted = true;
	  		btn.textContent = '🔇';
	  	}
	}
	  
	setRadioVolume(value) {
	  	this.radioVolume = value / 100;
	  	this.radioAudio.volume = this.radioVolume;
	}
	  
	setRadioStation(station) {
	  	// Stop current playback
	  	this.radioAudio.pause();
	  	
	  	// Load new station
	  	this.loadRadioPlaylist(station);
	  	
	  	// Start playing
	  	this.startRadio();
	}
	  
	updateRadioProgress() {
	  	if (!this.radioAudio.duration) return;
	  	
	  	const progress = (this.radioAudio.currentTime / this.radioAudio.duration) * 100;
	  	document.getElementById('radio-progress-bar').style.width = `${progress}%`;
	  	
	  	document.getElementById('radio-current-time').textContent = this.formatTime(this.radioAudio.currentTime);
	}
	  
	updateRadioDuration() {
	  	document.getElementById('radio-total-time').textContent = this.formatTime(this.radioAudio.duration);
	}
	
    // String hash function for consistent seeds
    String.prototype.hashCode = function() {
      let hash = 0;
      for (let i = 0; i < this.length; i++) {
        const char = this.charCodeAt(i);
        hash = ((hash << 5) - hash) + char;
        hash = hash & hash;
      }
      return Math.abs(hash);
    };

    // Initialize app
    let app;
    document.addEventListener('DOMContentLoaded', () => {
      app = new DailyGraceApp();
    });
  </script>
  
<!-- Footer -->
<footer style="background: var(--deep-navy); color: var(--text-light); padding: 3rem 0 2rem 0; margin-top: 3rem;">
    <div style="max-width: 1200px; margin: 0 auto; padding: 0 1rem;">
        <!-- Main Footer Content -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-bottom: 2rem;">
            
			<!-- About Section -->
			<div>
				<h4 style="color: var(--gold-accent); margin-bottom: 1rem; font-size: 1.1rem;">DailyGrace.Online</h4>
				<p style="font-size: 0.9rem; opacity: 0.9; line-height: 1.6;">
					Your personal devotional companion, providing AI-powered Christian meditations, prayers, spiritual guidance, and peaceful meditation music. 
					Connecting hearts to God through technology and faith.
				</p>
			</div>
            
			<!-- Support Section -->
			<div>
				<h4 style="color: var(--gold-accent); margin-bottom: 1rem; font-size: 1.1rem;">Our Mission</h4>
				<p style="font-size: 0.9rem; opacity: 0.9; line-height: 1.6; margin-bottom: 1rem;">
					DailyGrace.Online is free to use because communing with God should never cost money. 
					If you've been blessed by this ministry and would like to help, 
					any contribution is gratefully received and appreciated.
				</p>
				<p style="font-size: 0.85rem; opacity: 0.8; line-height: 1.5; margin-bottom: 1rem;">
					Donations are processed through our parent ministry, 
					<a href="https://ai-ministries.com" target="_blank" rel="noopener" 
					   style="color: var(--gold-accent); text-decoration: none;">AI-Ministries.com</a>, 
					which supports multiple AI based projects.
				</p>
				<a href="https://paypal.me/ReverendDrTolerant?country.x=US&locale.x=en_US" target="_blank" rel="noopener" 
				   style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; 
						  background: var(--gold-accent); color: var(--deep-navy); text-decoration: none; 
						  border-radius: 25px; font-weight: 600; transition: all 0.3s ease;">
					💝 Donate to DailyGrace.Online
				</a>
			</div>
            
            <!-- Legal & Policies -->
            <div>
                <h4 style="color: var(--gold-accent); margin-bottom: 1rem; font-size: 1.1rem;">Legal & Privacy</h4>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <a href="#" onclick="app.showPrivacyPolicy()" style="color: var(--soft-blue); text-decoration: none; font-size: 0.9rem;">Privacy Policy</a>
                    <a href="#" onclick="app.showTermsOfService()" style="color: var(--soft-blue); text-decoration: none; font-size: 0.9rem;">Terms of Service</a>
                    <a href="#" onclick="app.showCookiePolicy()" style="color: var(--soft-blue); text-decoration: none; font-size: 0.9rem;">Cookie Policy</a>
                    <a href="#" onclick="app.sendEmail()" style="color: var(--soft-blue); text-decoration: none; font-size: 0.9rem;">Contact Us</a>
                </div>
            </div>
        </div>
        
        <!-- Bottom Bar -->
        <div style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 2rem; text-align: center;">
            <p style="margin-bottom: 0.5rem; font-size: 0.9rem;">
                © <span id="copyright-year"></span> DailyGrace.online - All rights reserved | <a href="https://discord.gg/DcT9HX22vD" target="_blank" rel="noopener" 
                style="color: var(--white-accent); text-decoration: none;">Visit our DISCORD</a>
            </p>
            <p style="font-size: 0.8rem; opacity: 0.7;">
                AI content generation powered by <a href="https://pollinations.ai" target="_blank" rel="noopener" 
                style="color: var(--gold-accent); text-decoration: none;">Pollinations.ai</a> • 
                Made with ❤️ for the body of Christ
            </p>
        </div>
    </div>
</footer>
  
</body>
</html>		  